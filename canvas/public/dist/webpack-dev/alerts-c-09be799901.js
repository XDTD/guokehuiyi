(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([["alerts"],{

/***/ "R4uz":
/*!***********************************************************************!*\
  !*** ./frontend_build/i18n.js?alerts!./ui/shims/dummyI18nResource.js ***!
  \***********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n/i18nObj */ \"HGxv\");\n/* harmony import */ var translations_core_en__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! translations/_core_en */ \"0sPK\");\n\n    \n    \n    \n\n    /* harmony default export */ __webpack_exports__[\"default\"] = (_canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__[\"default\"].scoped('alerts'));\n  \n\n//# sourceURL=webpack:///./ui/shims/dummyI18nResource.js?./frontend_build/i18n.js?alerts");

/***/ }),

/***/ "Re9P":
/*!*************************************!*\
  !*** ./ui/features/alerts/index.js ***!
  \*************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _jquery_index__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jquery/index */ \"v7Dd\");\n/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n//# sourceURL=webpack:///./ui/features/alerts/index.js?");

/***/ }),

/***/ "XKWA":
/*!*********************************************!*\
  !*** ./packages/jquery-tinypubsub/index.js ***!
  \*********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/*!\n * jQuery Tiny Pub/Sub - v0.6 - 1/10/2011\n * http://benalman.com/\n *\n * Copyright (c) 2010 \"Cowboy\" Ben Alman\n * Dual licensed under the MIT and GPL licenses.\n * http://benalman.com/about/license/\n */\n\nconst $ = __webpack_require__(/*! jquery */ \"ouhR\")\n\n  // Create a \"dummy\" jQuery object on which to bind, unbind and trigger event\n  // handlers. Note that $({}) works in jQuery 1.4.3+.\n  var o = $({}), subscribe, unsubscribe, publish;\n\n  // Subscribe to a topic. Works just like bind, except the passed handler\n  // is wrapped in a function so that the event object can be stripped out.\n  // Even though the event object might be useful, it is unnecessary and\n  // will only complicate things in the future should the user decide to move\n  // to a non-$.event-based pub/sub implementation.\n  $.subscribe = subscribe = function( topic, fn ) {\n    if ($.isPlainObject(topic)) {\n      return $.each(topic, function(topic, fn) {\n        subscribe(topic, fn);\n      });\n    }\n    // Call fn, stripping out the 1st argument (the event object).\n    function wrapper() {\n      return fn.apply( this, Array.prototype.slice.call( arguments, 1 ) );\n    }\n\n    // Add .guid property to function to allow it to be easily unbound. Note\n    // that $.guid is new in jQuery 1.4+, and $.event.guid was used before.\n    wrapper.guid = fn.guid = fn.guid || $.guid++;\n\n    // Bind the handler.\n    o.bind( topic, wrapper );\n  };\n\n  // Unsubscribe from a topic. Works exactly like unbind.\n  $.unsubscribe = unsubscribe = function() {\n    o.unbind.apply( o, arguments );\n  };\n\n  // Publish a topic. Works exactly like trigger.\n  $.publish = publish = function() {\n    o.trigger.apply( o, arguments );\n  };\n\n  module.exports = {\n    subscribe: subscribe,\n    unsubscribe: unsubscribe,\n    publish: publish\n  };\n\n\n\n//# sourceURL=webpack:///./packages/jquery-tinypubsub/index.js?");

/***/ }),

/***/ "v7Dd":
/*!********************************************!*\
  !*** ./ui/features/alerts/jquery/index.js ***!
  \********************************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var i18n_alerts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! i18n!alerts */ \"R4uz\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ \"ouhR\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var html_escape__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! html-escape */ \"gI0r\");\n/* harmony import */ var _canvas_jquery_jquery_ajaxJSON__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/jquery/jquery.ajaxJSON */ \"dhbk\");\n/* harmony import */ var _canvas_forms_jquery_jquery_instructure_forms__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/forms/jquery/jquery.instructure_forms */ \"Dhso\");\n/* harmony import */ var _canvas_jquery_jquery_instructure_misc_helpers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @canvas/jquery/jquery.instructure_misc_helpers */ \"8JEM\");\n/* harmony import */ var jquery_tinypubsub__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! jquery-tinypubsub */ \"XKWA\");\n/* harmony import */ var jquery_tinypubsub__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery_tinypubsub__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var jqueryui_button__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jqueryui/button */ \"YLvb\");\n/*\n * Copyright (C) 2011 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n // validateForm, formErrors, errorBox\n\n // replaceTags\n\n // /\\.publish/\n\n\njquery__WEBPACK_IMPORTED_MODULE_1___default()(function () {\n  const $list = jquery__WEBPACK_IMPORTED_MODULE_1___default()('.alerts_list');\n\n  const getAlertData = function ($alert) {\n    const criteria = [];\n    $alert.find('ul.criteria li').each(function () {\n      criteria.push({\n        id: jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).find('input[name=\"alert[criteria][][id]\"]').attr('value'),\n        criterion_type: jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data('value'),\n        threshold: jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).find('span').text()\n      });\n    });\n    const recipients = [];\n    $alert.find('ul.recipients li').each(function () {\n      recipients.push(jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).data('value'));\n    });\n    let repetition = $alert.find('input[name=\"repetition\"]:checked').attr('value');\n\n    if (repetition == 'value') {\n      repetition = $alert.find('input[name=\"alert[repetition]\"]').attr('value');\n    } else {\n      repetition = null;\n    }\n\n    return {\n      criteria,\n      recipients,\n      repetition\n    };\n  };\n\n  const addRecipientInOrder = function ($node, $item) {\n    $node.append($item);\n    return $item;\n  };\n\n  const createElement = function (key, element, value, lookup) {\n    // xsslint safeString.identifier element\n    const $element = jquery__WEBPACK_IMPORTED_MODULE_1___default()('<' + element + ' />');\n    $element.data('value', key);\n    let contentHtml = Object(html_escape__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(lookup[key][value]).toString(); // see placeholder in _alerts.html.erb\n\n    contentHtml = contentHtml.replace('%{count}', \"<span class='displaying' /><input type='text' name='alert[criteria][][threshold]' class='editing' size='2' />\");\n    $element.html(contentHtml);\n\n    if (element == 'li') {\n      $element.append(' ');\n      $element.append($list.find('>.delete_item_link').clone().toggle());\n    } else {\n      $element.attr('value', key);\n    }\n\n    return $element;\n  }; // xsslint jqueryObject.function createRecipient createCriterion\n\n\n  const createRecipient = function (recipient, element) {\n    const $element = createElement(recipient, element, 'label', ENV.ALERTS.POSSIBLE_RECIPIENTS);\n\n    if (element == 'li') {\n      $element.prepend(jquery__WEBPACK_IMPORTED_MODULE_1___default()(\"<input type='hidden' name='alert[recipients][]' />\").attr('value', recipient));\n    }\n\n    return $element;\n  };\n\n  const createCriterion = function (criterion, element) {\n    let criterion_type = criterion,\n        threshold,\n        id;\n\n    if (typeof criterion === 'object') {\n      criterion_type = criterion.criterion_type;\n      threshold = criterion.threshold;\n      id = criterion.id;\n    }\n\n    const $element = createElement(criterion_type, element, element == 'li' ? 'label' : 'option', ENV.ALERTS.POSSIBLE_CRITERIA);\n\n    if (element == 'li') {\n      if (!threshold) {\n        threshold = ENV.ALERTS.POSSIBLE_CRITERIA[criterion_type].default_threshold;\n      }\n\n      $element.find('span').text(threshold);\n      $element.find('input').attr('value', threshold).attr('title', ENV.ALERTS.POSSIBLE_CRITERIA[criterion_type].title);\n      $element.prepend(jquery__WEBPACK_IMPORTED_MODULE_1___default()(\"<input type='hidden' name='alert[criteria][][criterion_type]' />\").attr('value', criterion_type));\n\n      if (id) {\n        $element.prepend(jquery__WEBPACK_IMPORTED_MODULE_1___default()(\"<input type='hidden' name='alert[criteria][][id]' />\").attr('value', id));\n      }\n    }\n\n    return $element;\n  };\n\n  const restoreAlert = function ($alert, data) {\n    const $criteria = $alert.find('.criteria');\n    $criteria.empty();\n\n    for (var idx in data.criteria) {\n      $criteria.append(createCriterion(data.criteria[idx], 'li'));\n    }\n\n    const $recipients = $alert.find('.recipients');\n    $recipients.empty();\n\n    for (var idx in data.recipients) {\n      if (ENV.ALERTS.POSSIBLE_RECIPIENTS[data.recipients[idx]]) {\n        $recipients.append(createRecipient(data.recipients[idx], 'li'));\n      }\n    }\n\n    if (data.repetition) {\n      $alert.find('input[name=\"repetition\"][value=\"value\"]').attr('checked', true);\n      $alert.find('input[name=\"alert[repetition]\"]').attr('value', data.repetition);\n      $alert.find('.repetition_group .no_repetition').toggle(false);\n      $alert.find('.repetition_group .repetition').toggle(true).find('span').text(data.repetition);\n    } else {\n      $alert.find('input[name=\"repetition\"][value=\"none\"]').attr('checked', true);\n      $alert.find('.repetition_group .no_repetition').toggle(true);\n      $alert.find('.repetition_group .repetition').toggle(false);\n    }\n  };\n\n  for (const idx in ENV.ALERTS.DATA) {\n    const alert = ENV.ALERTS.DATA[idx];\n    restoreAlert(jquery__WEBPACK_IMPORTED_MODULE_1___default()('#edit_alert_' + alert.id), alert);\n  }\n\n  jquery__WEBPACK_IMPORTED_MODULE_1___default()('.add_alert_link').click(function (event) {\n    event.preventDefault();\n    const $blank = jquery__WEBPACK_IMPORTED_MODULE_1___default()('.alert.blank');\n    const $alert = $blank.clone();\n    $alert.removeClass('blank');\n    $alert.addClass('new');\n\n    if ($list.find('.alert:visible').length != 0) {\n      jquery__WEBPACK_IMPORTED_MODULE_1___default()('<div class=\"alert_separator\"></div>').insertBefore($blank);\n    }\n\n    const rand = Math.floor(Math.random() * 100000000);\n    $alert.find('input').each(function () {\n      jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).attr('id', jquery__WEBPACK_IMPORTED_MODULE_1___default.a.replaceTags(jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).attr('id'), 'id', rand));\n    });\n    $alert.find('label').each(function () {\n      jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).attr('for', jquery__WEBPACK_IMPORTED_MODULE_1___default.a.replaceTags(jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).attr('for'), 'id', rand));\n    });\n    $alert.insertBefore($blank);\n    $alert.find('.edit_link').trigger('click');\n    $alert.toggle(false);\n    $alert.slideDown();\n  });\n  $list.delegate('.edit_link', 'click', function () {\n    const $alert = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert');\n    const data = getAlertData($alert);\n    $alert.data('data', data);\n    const $criteria_select = $alert.find('.add_criterion_link').prev();\n    $criteria_select.empty();\n    let count = 0;\n\n    for (var idx in ENV.ALERTS.POSSIBLE_CRITERIA_ORDER) {\n      const criterion = ENV.ALERTS.POSSIBLE_CRITERIA_ORDER[idx];\n      let found = -1;\n\n      for (const jdx in data.criteria) {\n        if (data.criteria[jdx].criterion_type == criterion) {\n          found = jdx;\n          break;\n        }\n      }\n\n      if (found == -1) {\n        $criteria_select.append(createCriterion(criterion, 'option'));\n        count += 1;\n      }\n    }\n\n    if (count == 0) {\n      $alert.find('.add_criteria_line').toggle(false);\n    }\n\n    const $recipients_select = $alert.find('.add_recipient_link').prev();\n    $recipients_select.empty();\n    count = 0;\n\n    for (var idx in ENV.ALERTS.POSSIBLE_RECIPIENTS_ORDER) {\n      const recipient = ENV.ALERTS.POSSIBLE_RECIPIENTS_ORDER[idx];\n\n      if (jquery__WEBPACK_IMPORTED_MODULE_1___default.a.inArray(recipient, data.recipients) == -1) {\n        $recipients_select.append(createRecipient(recipient, 'option'));\n        count += 1;\n      }\n    }\n\n    if (count == 0) {\n      $alert.find('.add_recipients_line').toggle(false);\n    }\n\n    $alert.find('.repetition_group label').toggle(true);\n    $alert.toggleClass('editing');\n    $alert.toggleClass('displaying');\n    return false;\n  }).delegate('.delete_link', 'click', function () {\n    const $alert = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert');\n\n    if (!$alert.hasClass('new')) {\n      $alert.find('input[name=\"_method\"]').attr('value', 'DELETE');\n      jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON($alert.attr('action'), 'POST', $alert.serialize(), data => {\n        $alert.slideUp(() => {\n          $alert.remove();\n          $list.find('.alert:first').prev('.alert_separator').remove();\n          $list.find('.alert_separator + .alert_separator').remove();\n          $list.find('.alert:visible:last').next('.alert_separator').remove();\n        });\n      });\n    } else {\n      $alert.slideUp(() => {\n        $alert.remove();\n        $list.find('.alert:first').prev('.alert_separator').remove();\n        $list.find('.alert_separator + .alert_separator').remove();\n        $list.find('.alert:visible:last').next('.alert_separator').remove();\n      });\n    }\n\n    return false;\n  }).delegate('.cancel_button', 'click', function () {\n    jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().hideErrors();\n    const $alert = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert');\n\n    if ($alert.hasClass('new')) {\n      $alert.slideUp(() => {\n        $alert.remove();\n        $list.find('.alert:first').prev('.alert_separator').remove();\n        $list.find('.alert_separator + .alert_separator').remove();\n        $list.find('.alert:visible:last').next('.alert_separator').remove();\n      });\n    } else {\n      const data = $alert.data('data');\n      restoreAlert($alert, data);\n      $alert.toggleClass('editing', false);\n      $alert.toggleClass('displaying', true);\n    }\n\n    return false;\n  }).delegate('.alert', 'submit', function () {\n    const $alert = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this); // Validation (validateForm doesn't support arrays, and formErrors\n    // wouldn't be able to locate the correct elements)\n\n    const errors = [];\n\n    if ($alert.find('.criteria li').length == 0) {\n      errors.push([$alert.find('.add_criterion_link').prev(), i18n_alerts__WEBPACK_IMPORTED_MODULE_0__[\"default\"].t('errors.criteria_required', 'At least one trigger is required')]);\n    }\n\n    $alert.find('.criteria input.editing').each(function () {\n      const val = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).attr('value');\n\n      if (!val || isNaN(val) || parseFloat(val) < 0) {\n        errors.push([jquery__WEBPACK_IMPORTED_MODULE_1___default()(this), i18n_alerts__WEBPACK_IMPORTED_MODULE_0__[\"default\"].t('errors.threshold_should_be_numeric', 'This should be a positive number')]);\n      }\n    });\n\n    if ($alert.find('.recipients li').length == 0) {\n      errors.push([$alert.find('.add_recipient_link').prev(), i18n_alerts__WEBPACK_IMPORTED_MODULE_0__[\"default\"].t('errors.recipients_required', 'At least one recipient is required')]);\n    }\n\n    if ($alert.find('input[name=\"repetition\"]:checked').attr('value') == 'none') {\n      $alert.find('input[name=\"alert[repetition]\"]').attr('value', '');\n    } else {\n      const $repetition = $alert.find('input[name=\"alert[repetition]\"]');\n      const val = $repetition.attr('value');\n\n      if (!val || isNaN(val) || parseFloat(val) < 0) {\n        errors.push([$repetition, i18n_alerts__WEBPACK_IMPORTED_MODULE_0__[\"default\"].t('errors.threshold_should_be_numeric', 'This should be a positive number')]);\n      }\n    }\n\n    if (errors.length != 0) {\n      $alert.formErrors(errors);\n      return false;\n    }\n\n    jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON($alert.attr('action'), 'POST', $alert.serialize(), (data, xhr) => {\n      $alert.removeClass('new');\n      $alert.attr('action', xhr.getResponseHeader('Location'));\n      const $method = $alert.find('input[name=\"_method\"]');\n\n      if ($method.length == 0) {\n        $alert.append(jquery__WEBPACK_IMPORTED_MODULE_1___default()('<input type=\"hidden\" name=\"_method\" value=\"put\" />'));\n      }\n\n      $alert.toggleClass('editing', false);\n      $alert.toggleClass('displaying', true);\n      restoreAlert($alert, data);\n    }, data => {\n      $alert.formErrors(data);\n    });\n    return false;\n  }).delegate('.recipients .delete_item_link', 'click', function () {\n    const $li = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('li');\n    const $add_link = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('.add_recipient_link');\n    addRecipientInOrder($add_link.prev(), createRecipient($li.data('value'), 'option'));\n    $li.slideUp(() => {\n      $li.remove();\n    });\n    $add_link.parent().slideDown(() => {\n      $add_link.parent().css('display', '');\n    });\n    return false;\n  }).delegate('.add_recipient_link', 'click', function () {\n    const $recipients = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('.recipients');\n    const $select = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).prev();\n    const recipient = $select.attr('value');\n    addRecipientInOrder($recipients, createRecipient(recipient, 'li')).toggle().slideDown();\n    const $errorBox = $select.data('associated_error_box');\n\n    if ($errorBox) {\n      $errorBox.fadeOut('slow', () => {\n        $errorBox.remove();\n      });\n    }\n\n    $select.find('option[value=\"' + recipient + '\"]').remove();\n\n    if ($select.find('*').length == 0) {\n      jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().slideUp();\n    }\n\n    return false;\n  }).delegate('.criteria .delete_item_link', 'click', function () {\n    const $li = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('li');\n    const $add_link = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('.add_criterion_link');\n    addRecipientInOrder($add_link.prev(), createCriterion($li.data('value'), 'option'));\n    $li.slideUp(() => {\n      $li.remove();\n    });\n    $add_link.parent().slideDown(() => {\n      $add_link.parent().css('display', '');\n    });\n    return false;\n  }).delegate('.add_criterion_link', 'click', function () {\n    const $criteria = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('.criteria');\n    const $select = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).prev();\n    const criterion = $select.attr('value');\n    addRecipientInOrder($criteria, createCriterion(criterion, 'li')).toggle().slideDown();\n    const $errorBox = $select.data('associated_error_box');\n\n    if ($errorBox) {\n      $errorBox.fadeOut('slow', () => {\n        $errorBox.remove();\n      });\n    }\n\n    $select.find('option[value=\"' + criterion + '\"]').remove();\n\n    if ($select.find('*').length == 0) {\n      jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parent().slideUp();\n    }\n\n    return false;\n  }).delegate('input[name=\"repetition\"]', 'click', function () {\n    const $error_box = jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('input[name=\"alert[repetition]\"]').data('associated_error_box');\n\n    if ($error_box) {\n      $error_box.fadeOut('slow', () => {\n        $error_box.remove();\n      });\n    }\n  }).delegate('label.repetition', 'click', function (event) {\n    event.preventDefault();\n    jquery__WEBPACK_IMPORTED_MODULE_1___default()(this).parents('.alert').find('input[name=\"repetition\"]').prop('checked', true);\n  });\n});\n\n//# sourceURL=webpack:///./ui/features/alerts/jquery/index.js?");

/***/ })

}]);