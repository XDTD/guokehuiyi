(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([["external_content_success"],{

/***/ "5a7x":
/*!*******************************************************!*\
  !*** ./ui/features/external_content_success/index.js ***!
  \*******************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"ouhR\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var i18n_external_content_success__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18n!external_content.success */ \"RHUa\");\n/* harmony import */ var _canvas_jquery_jquery_ajaxJSON__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @canvas/jquery/jquery.ajaxJSON */ \"dhbk\");\n/* harmony import */ var _canvas_jquery_jquery_instructure_misc_helpers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/jquery/jquery.instructure_misc_helpers */ \"8JEM\");\n/* harmony import */ var _canvas_rails_flash_notifications__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/rails-flash-notifications */ \"r2Yr\");\n//\n// Copyright (C) 2014 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\n\n\n\n\nconst ExternalContentSuccess = {};\nconst _ENV = ENV,\n      lti_response_messages = _ENV.lti_response_messages;\nconst _ENV2 = ENV,\n      service_id = _ENV2.service_id;\nconst data = ENV.retrieved_data;\nconst callback = ENV.service;\nlet parentWindow = window.parent || window.opener;\n\nExternalContentSuccess.getIFrameSrc = function () {\n  let src = parentWindow.$('[data-cid=\"Modal\"]').find('iframe').attr('src');\n\n  if (src === void 0) {\n    src = parentWindow.$('[data-cid=\"Tray\"]').find('iframe').attr('src');\n  }\n\n  return src;\n};\n\nExternalContentSuccess.getLaunchType = function () {\n  const src = ExternalContentSuccess.getIFrameSrc();\n\n  if (src === void 0) {\n    return void 0;\n  }\n\n  const params = new URLSearchParams(src.split('?')[1]);\n  return params.get('launch_type');\n};\n\nExternalContentSuccess.dataReady = function (data, service_id) {\n  const e = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.Event('externalContentReady');\n  e.contentItems = data;\n  e.service_id = service_id;\n  parentWindow.$(parentWindow).trigger('externalContentReady', e);\n\n  if (parentWindow[callback] && parentWindow[callback].ready) {\n    parentWindow[callback].ready(data);\n    setTimeout(() => {\n      if (callback === 'external_tool_dialog') {\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()('#dialog_message').text(i18n_external_content_success__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('popup_success', 'Success! This popup should close on its own...'));\n      } else {\n        jquery__WEBPACK_IMPORTED_MODULE_0___default()('#dialog_message').text('');\n      }\n    }, 1000);\n  } else {\n    jquery__WEBPACK_IMPORTED_MODULE_0___default()('#dialog_message').text(i18n_external_content_success__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('content_failure', 'Content retrieval failed, please try again or notify your system administrator of the error.'));\n  }\n}; // Handles lti 1.0 responses for Assignments 2 which expects a\n// vanilla JS event from LTI tools in the following form.\n\n\nExternalContentSuccess.a2DataReady = function (data) {\n  parentWindow.postMessage({\n    messageType: 'A2ExternalContentReady',\n    content_items: data,\n    msg: ENV.message,\n    log: ENV.log,\n    errormsg: ENV.error_message,\n    errorlog: ENV.error_log,\n    ltiEndpoint: ENV.lti_endpoint\n  }, ENV.DEEP_LINKING_POST_MESSAGE_ORIGIN);\n};\n\nExternalContentSuccess.start = function () {\n  while (parentWindow && parentWindow.parent !== parentWindow && !parentWindow[callback]) {\n    parentWindow = parentWindow.parent;\n  }\n\n  if (parentWindow.$ === void 0) {\n    parentWindow.$ = jquery__WEBPACK_IMPORTED_MODULE_0___default.a;\n  }\n\n  if (lti_response_messages && lti_response_messages.lti_errormsg) {\n    parentWindow.$.flashError(lti_response_messages.lti_errormsg);\n  }\n\n  if (lti_response_messages && lti_response_messages.lti_msg) {\n    parentWindow.$.flashMessage(lti_response_messages.lti_msg);\n  }\n\n  if (ENV.oembed) {\n    const url = jquery__WEBPACK_IMPORTED_MODULE_0___default.a.replaceTags(jquery__WEBPACK_IMPORTED_MODULE_0___default.a.replaceTags(jquery__WEBPACK_IMPORTED_MODULE_0___default()('#oembed_retrieve_url').attr('href'), 'endpoint', encodeURIComponent(ENV.oembed.endpoint)), 'url', encodeURIComponent(ENV.oembed.url));\n    jquery__WEBPACK_IMPORTED_MODULE_0___default.a.ajaxJSON(url, 'GET', {}, data => ExternalContentSuccess.dataReady(data), () => jquery__WEBPACK_IMPORTED_MODULE_0___default()('#dialog_message').text(i18n_external_content_success__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('oembed_failure', 'Content retrieval failed, please try again or notify your system administrator of the error.')));\n  } else if (ExternalContentSuccess.getLaunchType() === 'assignment_index_menu') {\n    parentWindow.location.reload();\n  } else {\n    ExternalContentSuccess.dataReady(data, service_id);\n    ExternalContentSuccess.a2DataReady(data);\n  }\n};\n\njquery__WEBPACK_IMPORTED_MODULE_0___default()(document).ready(() => {\n  ExternalContentSuccess.start();\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (ExternalContentSuccess);\n\n//# sourceURL=webpack:///./ui/features/external_content_success/index.js?");

/***/ }),

/***/ "RHUa":
/*!*****************************************************************************************!*\
  !*** ./frontend_build/i18n.js?external_content.success!./ui/shims/dummyI18nResource.js ***!
  \*****************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n/i18nObj */ \"HGxv\");\n/* harmony import */ var translations_core_en__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! translations/_core_en */ \"0sPK\");\n\n    \n    \n    \n\n    /* harmony default export */ __webpack_exports__[\"default\"] = (_canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__[\"default\"].scoped('external_content.success'));\n  \n\n//# sourceURL=webpack:///./ui/shims/dummyI18nResource.js?./frontend_build/i18n.js?external_content.success");

/***/ })

}]);