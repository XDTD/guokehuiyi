(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([[159],{

/***/ "3l1C":
/*!***************************************************!*\
  !*** ./ui/shared/quizzes/backbone/models/Quiz.js ***!
  \***************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return Quiz; });\n/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ \"VTBJ\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jquery */ \"ouhR\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var underscore__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! underscore */ \"Y/W1\");\n/* harmony import */ var underscore__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(underscore__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _canvas_backbone__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @canvas/backbone */ \"mX+G\");\n/* harmony import */ var _canvas_backbone__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_canvas_backbone__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _canvas_assignments_backbone_models_Assignment_coffee__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/assignments/backbone/models/Assignment.coffee */ \"ygkh\");\n/* harmony import */ var _canvas_date_group_backbone_models_DateGroup__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @canvas/date-group/backbone/models/DateGroup */ \"B9nD\");\n/* harmony import */ var _canvas_assignments_backbone_collections_AssignmentOverrideCollection_coffee__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @canvas/assignments/backbone/collections/AssignmentOverrideCollection.coffee */ \"85Cn\");\n/* harmony import */ var _canvas_date_group_backbone_collections_DateGroupCollection_coffee__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @canvas/date-group/backbone/collections/DateGroupCollection.coffee */ \"GEFT\");\n/* harmony import */ var i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! i18n!modelsQuiz */ \"sfEq\");\n/* harmony import */ var _canvas_jquery_jquery_ajaxJSON__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @canvas/jquery/jquery.ajaxJSON */ \"dhbk\");\n/* harmony import */ var _canvas_jquery_jquery_instructure_misc_helpers__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @canvas/jquery/jquery.instructure_misc_helpers */ \"8JEM\");\n/* harmony import */ var _canvas_panda_pub_poller__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @canvas/panda-pub-poller */ \"cRz0\");\n\n//\n// Copyright (C) 2013 - present Instructure, Inc.\n//\n// This file is part of Canvas.\n//\n// Canvas is free software: you can redistribute it and/or modify it under\n// the terms of the GNU Affero General Public License as published by the Free\n// Software Foundation, version 3 of the License.\n//\n// Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n// A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n// details.\n//\n// You should have received a copy of the GNU Affero General Public License along\n// with this program. If not, see <http://www.gnu.org/licenses/>.\n\n\n\n\n\n\n\n\n\n\n\nclass Quiz extends _canvas_backbone__WEBPACK_IMPORTED_MODULE_3___default.a.Model {\n  initialize() {\n    this.publish = this.publish.bind(this);\n    this.unpublish = this.unpublish.bind(this);\n    this.dueAt = this.dueAt.bind(this);\n    this.unlockAt = this.unlockAt.bind(this);\n    this.lockAt = this.lockAt.bind(this);\n    this.name = this.name.bind(this);\n    this.htmlUrl = this.htmlUrl.bind(this);\n    this.defaultDates = this.defaultDates.bind(this);\n    this.multipleDueDates = this.multipleDueDates.bind(this);\n    this.nonBaseDates = this.nonBaseDates.bind(this);\n    this.allDates = this.allDates.bind(this);\n    this.singleSectionDueDate = this.singleSectionDueDate.bind(this);\n    this.postToSIS = this.postToSIS.bind(this);\n    this.postToSISName = this.postToSISName.bind(this);\n    this.sisIntegrationSettingsEnabled = this.sisIntegrationSettingsEnabled.bind(this);\n    this.maxNameLength = this.maxNameLength.bind(this);\n    this.maxNameLengthRequiredForAccount = this.maxNameLengthRequiredForAccount.bind(this);\n    this.dueDateRequiredForAccount = this.dueDateRequiredForAccount.bind(this);\n    this.toView = this.toView.bind(this);\n    this.postToSISEnabled = this.postToSISEnabled.bind(this);\n    this.objectType = this.objectType.bind(this);\n    this.isDuplicating = this.isDuplicating.bind(this);\n    this.isMigrating = this.isMigrating.bind(this);\n    this.importantDates = this.importantDates.bind(this);\n    super.initialize(...arguments);\n    this.initId();\n    this.initAssignment();\n    this.initAssignmentOverrides();\n    this.initUrls();\n    this.initTitleLabel();\n    this.initUnpublishable();\n    this.initQuestionsCount();\n    this.initPointsCount();\n    return this.initAllDates();\n  } // initialize attributes\n\n\n  initId() {\n    this.id = this.isQuizzesNext() ? `assignment_${this.get('id')}` : this.get('id');\n  }\n\n  initAssignment() {\n    if (this.attributes.assignment) {\n      this.set('assignment', new _canvas_assignments_backbone_models_Assignment_coffee__WEBPACK_IMPORTED_MODULE_4__[\"default\"](this.attributes.assignment));\n    }\n\n    return this.set('post_to_sis_enabled', this.postToSISEnabled());\n  }\n\n  initAssignmentOverrides() {\n    if (this.attributes.assignment_overrides) {\n      const overrides = new _canvas_assignments_backbone_collections_AssignmentOverrideCollection_coffee__WEBPACK_IMPORTED_MODULE_6__[\"default\"](this.attributes.assignment_overrides);\n      return this.set('assignment_overrides', overrides, {\n        silent: true\n      });\n    }\n  }\n\n  initUrls() {\n    if (this.get('html_url')) {\n      this.set('base_url', this.get('html_url').replace(/(quizzes|assignments)\\/\\d+/, '$1'));\n      this.set('url', this.url());\n      this.set('edit_url', this.edit_url());\n      this.set('publish_url', this.publish_url());\n      this.set('deletion_url', this.deletion_url());\n      this.set('unpublish_url', this.unpublish_url());\n    }\n  }\n\n  initTitleLabel() {\n    return this.set('title_label', this.get('title') || this.get('readable_type'));\n  }\n\n  initUnpublishable() {\n    if (this.get('can_unpublish') === false && this.get('published')) {\n      return this.set('unpublishable', false);\n    }\n  }\n\n  initQuestionsCount() {\n    const cnt = this.get('question_count');\n\n    if (cnt) {\n      this.set('question_count_label', i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__[\"default\"].t('question_count', 'Question', {\n        count: cnt\n      }));\n    }\n  }\n\n  initPointsCount() {\n    const pts = this.get('points_possible');\n    let text = '';\n\n    if (pts && pts > 0 && !this.isUngradedSurvey()) {\n      text = Number.isInteger(pts) ? i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__[\"default\"].t('assignment_points_possible', 'pt', {\n        count: pts\n      }) : i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__[\"default\"].t('%{points} pts', {\n        points: i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__[\"default\"].n(pts)\n      });\n    }\n\n    return this.set('possible_points_label', text);\n  }\n\n  isQuizzesNext() {\n    return this.get('quiz_type') === 'quizzes.next';\n  }\n\n  isUngradedSurvey() {\n    return this.get('quiz_type') === 'survey';\n  }\n\n  publish_url() {\n    if (this.isQuizzesNext()) {\n      return `${this.get('base_url')}/publish/quiz`;\n    }\n\n    return `${this.get('base_url')}/publish`;\n  }\n\n  unpublish_url() {\n    if (this.isQuizzesNext()) {\n      return `${this.get('base_url')}/unpublish/quiz`;\n    }\n\n    return `${this.get('base_url')}/unpublish`;\n  }\n\n  url() {\n    var _ENV$PERMISSIONS, _ENV$FLAGS;\n\n    if (this.isQuizzesNext() && (_ENV$PERMISSIONS = ENV.PERMISSIONS) !== null && _ENV$PERMISSIONS !== void 0 && _ENV$PERMISSIONS.manage && (_ENV$FLAGS = ENV.FLAGS) !== null && _ENV$FLAGS !== void 0 && _ENV$FLAGS.new_quizzes_modules_support) {\n      return this.edit_url();\n    }\n\n    return `${this.get('base_url')}/${this.get('id')}`;\n  }\n\n  edit_url() {\n    const query_string = this.isQuizzesNext() ? '?quiz_lti' : '';\n    return `${this.get('base_url')}/${this.get('id')}/edit${query_string}`;\n  }\n\n  deletion_url() {\n    if (this.isQuizzesNext()) {\n      return `${this.get('base_url')}/${this.get('id')}`;\n    }\n\n    return this.get('url');\n  }\n\n  initAllDates() {\n    let allDates;\n\n    if ((allDates = this.get('all_dates')) != null) {\n      return this.set('all_dates', new _canvas_date_group_backbone_collections_DateGroupCollection_coffee__WEBPACK_IMPORTED_MODULE_7__[\"default\"](allDates));\n    }\n  } // publishing\n\n\n  publish() {\n    this.set('published', true);\n    return jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON(this.get('publish_url'), 'POST', {\n      quizzes: [this.get('id')]\n    });\n  }\n\n  unpublish() {\n    this.set('published', false);\n    return jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON(this.get('unpublish_url'), 'POST', {\n      quizzes: [this.get('id')]\n    });\n  }\n\n  disabledMessage() {\n    return i18n_modelsQuiz__WEBPACK_IMPORTED_MODULE_8__[\"default\"].t('cant_unpublish_when_students_submit', \"Can't unpublish if there are student submissions\");\n  } // methods needed by views\n\n\n  dueAt(date) {\n    if (!(arguments.length > 0)) return this.get('due_at');\n    return this.set('due_at', date);\n  }\n\n  unlockAt(date) {\n    if (!(arguments.length > 0)) return this.get('unlock_at');\n    return this.set('unlock_at', date);\n  }\n\n  lockAt(date) {\n    if (!(arguments.length > 0)) return this.get('lock_at');\n    return this.set('lock_at', date);\n  }\n\n  importantDates(important) {\n    if (!(arguments.length > 0)) return this.get('important_dates');\n    return this.set('important_dates', important);\n  }\n\n  isDuplicating() {\n    return this.get('workflow_state') === 'duplicating';\n  }\n\n  isMigrating() {\n    return this.get('workflow_state') === 'migrating';\n  }\n\n  name(newName) {\n    if (!(arguments.length > 0)) return this.get('title');\n    return this.set('title', newName);\n  }\n\n  htmlUrl() {\n    return this.get('url');\n  }\n\n  destroy(options) {\n    const opts = Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n      url: this.get('deletion_url')\n    }, options);\n\n    _canvas_backbone__WEBPACK_IMPORTED_MODULE_3___default.a.Model.prototype.destroy.call(this, opts);\n  }\n\n  defaultDates() {\n    return new _canvas_date_group_backbone_models_DateGroup__WEBPACK_IMPORTED_MODULE_5__[\"default\"]({\n      due_at: this.get('due_at'),\n      unlock_at: this.get('unlock_at'),\n      lock_at: this.get('lock_at')\n    });\n  } // caller is original assignments\n\n\n  duplicate(callback) {\n    const course_id = this.get('course_id');\n    const assignment_id = this.get('id');\n    return jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON(`/api/v1/courses/${course_id}/assignments/${assignment_id}/duplicate`, 'POST', {\n      quizzes: [assignment_id],\n      result_type: 'Quiz'\n    }, callback);\n  } // caller is failed assignments\n\n\n  duplicate_failed(callback) {\n    const target_course_id = this.get('course_id');\n    const target_assignment_id = this.get('id');\n    const original_course_id = this.get('original_course_id');\n    const original_assignment_id = this.get('original_assignment_id');\n    let query_string = `?target_assignment_id=${target_assignment_id}`;\n\n    if (original_course_id !== target_course_id) {\n      // when it's a course copy failure\n      query_string += `&target_course_id=${target_course_id}`;\n    }\n\n    jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON(`/api/v1/courses/${original_course_id}/assignments/${original_assignment_id}/duplicate${query_string}`, 'POST', {}, callback);\n  } // caller is failed migrated assignment\n\n\n  retry_migration(callback) {\n    const course_id = this.get('course_id');\n    const original_quiz_id = this.get('original_quiz_id');\n    jquery__WEBPACK_IMPORTED_MODULE_1___default.a.ajaxJSON(`/api/v1/courses/${course_id}/content_exports?export_type=quizzes2&quiz_id=${original_quiz_id}&include[]=migrated_quiz`, 'POST', {}, callback);\n  }\n\n  pollUntilFinishedLoading(interval) {\n    if (this.isDuplicating()) {\n      this.pollUntilFinished(interval, this.isDuplicating);\n    }\n\n    if (this.isMigrating()) {\n      this.pollUntilFinished(interval, this.isMigrating);\n    }\n  }\n\n  pollUntilFinished(interval, isProcessing) {\n    const course_id = this.get('course_id');\n    const id = this.get('id');\n    const poller = new _canvas_panda_pub_poller__WEBPACK_IMPORTED_MODULE_11__[\"default\"](interval, interval * 5, done => {\n      this.fetch({\n        url: `/api/v1/courses/${course_id}/assignments/${id}?result_type=Quiz`\n      }).always(() => {\n        done();\n\n        if (!isProcessing()) {\n          return poller.stop();\n        }\n      });\n    });\n    poller.start();\n  }\n\n  multipleDueDates() {\n    const dateGroups = this.get('all_dates');\n    return dateGroups && dateGroups.length > 1;\n  }\n\n  nonBaseDates() {\n    const dateGroups = this.get('all_dates');\n    if (!dateGroups) return false;\n\n    const withouBase = underscore__WEBPACK_IMPORTED_MODULE_2___default.a.filter(dateGroups, dateGroup => dateGroup && !dateGroup.get('base'));\n\n    return withouBase.length > 0;\n  }\n\n  allDates() {\n    const groups = this.get('all_dates');\n    const models = groups && groups.models || [];\n    return underscore__WEBPACK_IMPORTED_MODULE_2___default.a.map(models, group => group.toJSON());\n  }\n\n  singleSectionDueDate() {\n    return __guard__(underscore__WEBPACK_IMPORTED_MODULE_2___default.a.find(this.allDates(), 'dueAt'), x => x.dueAt.toISOString()) || this.dueAt();\n  }\n\n  isOnlyVisibleToOverrides(overrideFlag) {\n    if (!(arguments.length > 0)) return this.get('only_visible_to_overrides') || false;\n    return this.set('only_visible_to_overrides', overrideFlag);\n  }\n\n  postToSIS(postToSisBoolean) {\n    if (!(arguments.length > 0)) return this.get('post_to_sis');\n    return this.set('post_to_sis', postToSisBoolean);\n  }\n\n  postToSISName() {\n    return ENV.SIS_NAME;\n  }\n\n  sisIntegrationSettingsEnabled() {\n    return ENV.SIS_INTEGRATION_SETTINGS_ENABLED;\n  }\n\n  maxNameLength() {\n    return ENV.MAX_NAME_LENGTH;\n  }\n\n  maxNameLengthRequiredForAccount() {\n    return ENV.MAX_NAME_LENGTH_REQUIRED_FOR_ACCOUNT;\n  }\n\n  dueDateRequiredForAccount() {\n    return ENV.DUE_DATE_REQUIRED_FOR_ACCOUNT;\n  }\n\n  toView() {\n    const fields = ['htmlUrl', 'multipleDueDates', 'nonBaseDates', 'allDates', 'dueAt', 'lockAt', 'unlockAt', 'singleSectionDueDate', 'importantDates'];\n    const hash = {\n      id: this.get('id')\n    };\n\n    for (const field of fields) {\n      hash[field] = this[field]();\n    }\n\n    return hash;\n  }\n\n  postToSISEnabled() {\n    return ENV.FLAGS && ENV.FLAGS.post_to_sis_enabled;\n  }\n\n  objectType() {\n    return 'Quiz';\n  }\n\n}\nQuiz.prototype.resourceName = 'quizzes';\nQuiz.prototype.defaults = {\n  due_at: null,\n  unlock_at: null,\n  lock_at: null,\n  unpublishable: true,\n  points_possible: null,\n  post_to_sis: false,\n  require_lockdown_browser: false\n};\n\nfunction __guard__(value, transform) {\n  return typeof value !== 'undefined' && value !== null ? transform(value) : void 0;\n}\n\n//# sourceURL=webpack:///./ui/shared/quizzes/backbone/models/Quiz.js?");

/***/ }),

/***/ "sfEq":
/*!***************************************************************************!*\
  !*** ./frontend_build/i18n.js?modelsQuiz!./ui/shims/dummyI18nResource.js ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @canvas/i18n/i18nObj */ \"HGxv\");\n/* harmony import */ var translations_core_en__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! translations/_core_en */ \"0sPK\");\n\n    \n    \n    \n\n    /* harmony default export */ __webpack_exports__[\"default\"] = (_canvas_i18n_i18nObj__WEBPACK_IMPORTED_MODULE_0__[\"default\"].scoped('modelsQuiz'));\n  \n\n//# sourceURL=webpack:///./ui/shims/dummyI18nResource.js?./frontend_build/i18n.js?modelsQuiz");

/***/ })

}]);