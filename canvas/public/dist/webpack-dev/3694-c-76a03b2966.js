(window["canvasWebpackJsonp"] = window["canvasWebpackJsonp"] || []).push([[3694],{

/***/ "8k+u":
/*!************************************************************************************!*\
  !*** ./ui/shared/integrations/react/courses/microsoft_sync/MicrosoftSyncButton.js ***!
  \************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ \"ODXe\");\n/* harmony import */ var _babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/esm/objectSpread2 */ \"VTBJ\");\n/* harmony import */ var i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18n!course_settings */ \"3n31\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _canvas_do_fetch_api_effect__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/do-fetch-api-effect */ \"Ipg6\");\n/* harmony import */ var _instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-buttons */ \"K6WN\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/* harmony import */ var _instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-spinner */ \"cPO5\");\n\n\n\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\nconst readyStates = ['pending', 'errored', 'completed', 'scheduled'];\nconst coolDownRequiredStates = ['completed', 'manually_scheduled', 'scheduled'];\n\nconst syncReducer = (state, action) => {\n  switch (action.type) {\n    case 'SCHEDULE':\n      return Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state), {}, {\n        loading: true,\n        error: false,\n        previousError: state.error\n      });\n\n    case 'SCHEDULE_SUCCESS':\n      {\n        const group = action.payload.group;\n        const newSecondsRemaining = secondsUntilEditable(group, state.coolDownSeconds, state.canBypassCooldown);\n        return Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state), {}, {\n          loading: false,\n          group,\n          enabled: false,\n          previousError: state.error,\n          error: false,\n          secondsRemaining: newSecondsRemaining,\n          readyForManualSync: readyStates.includes(group.workflow_state),\n          // We don't need to show the countdown for Site Admins\n          showCountdown: coolDownRequiredStates.includes(group.workflow_state) && !state.canBypassCooldown\n        });\n      }\n\n    case 'SCHEDULE_FAILED':\n      return Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(Object(_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({}, state), {}, {\n        loading: false,\n        error: action.payload.error,\n        enabled: true\n      });\n\n    default:\n      throw new Error('Not implemented');\n  }\n};\n\nconst secondsUntilEditable = (group, coolDownSeconds, canBypassCooldown) => {\n  // Site admins can bypass the cooldown timer.\n  if (!group.last_manually_synced_at || canBypassCooldown) {\n    return 0; // No manual sync has ocurred yet- sync away!\n  } // Get the difference between the current time and the\n  // last manual sync time in seconds\n\n\n  const secondsElapsed = (new Date() - Date.parse(group.last_manually_synced_at)) / 1000;\n  return coolDownSeconds - secondsElapsed;\n};\n\nconst MicrosoftSyncButton = ({\n  enabled,\n  error,\n  group,\n  onError,\n  onSuccess,\n  onInfo,\n  courseId\n}) => {\n  const _useReducer = Object(react__WEBPACK_IMPORTED_MODULE_3__[\"useReducer\"])(syncReducer, {\n    loading: false,\n    error,\n    coolDownSeconds: ENV.MANUAL_MSFT_SYNC_COOLDOWN,\n    previousError: error,\n    secondsRemaining: secondsUntilEditable(group, ENV.MANUAL_MSFT_SYNC_COOLDOWN, ENV.MSFT_SYNC_CAN_BYPASS_COOLDOWN),\n    readyForManualSync: readyStates.includes(group.workflow_state),\n    showCountdown: coolDownRequiredStates.includes(group.workflow_state),\n    canBypassCooldown: ENV.MSFT_SYNC_CAN_BYPASS_COOLDOWN,\n    enabled,\n    group\n  }),\n        _useReducer2 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useReducer, 2),\n        state = _useReducer2[0],\n        dispatch = _useReducer2[1];\n\n  Object(react__WEBPACK_IMPORTED_MODULE_3__[\"useEffect\"])(() => onSuccess(state.group), [state.group, onSuccess]);\n  Object(react__WEBPACK_IMPORTED_MODULE_3__[\"useEffect\"])(() => {\n    // we don't want to clear the error state unless\n    // we've previously had an error in this component\n    if (state.error || state.previousError) {\n      onError(state.error);\n    }\n  }, [state.error, onError, state.previousError]);\n  Object(react__WEBPACK_IMPORTED_MODULE_3__[\"useEffect\"])(() => {\n    const recentlyScheduled = state.coolDownSeconds - state.secondsRemaining < 15; // A sync was just scheduled\n\n    if (recentlyScheduled) {\n      onInfo({\n        message: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync scheduled successfully! You may safely leave this page.'),\n        variant: 'success'\n      });\n    } // A sync is already scheduled or running\n\n\n    if (!state.readyForManualSync) {\n      setTimeout(() => {\n        onInfo(i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('A sync is currently running. Please wait for current sync to finish before starting another.'));\n      }, recentlyScheduled ? 5000 : 0 // Give time for the success message to show\n      );\n      return;\n    } // No sync is running, but the cooldown period has not completed\n\n\n    if (state.secondsRemaining > 0 && state.showCountdown) {\n      onInfo(i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Manual syncs are available every %{coolDown} minutes. Please wait %{minutesRemaining} minutes to sync again.', {\n        coolDown: Math.round(state.coolDownSeconds / 60),\n        minutesRemaining: Math.round(state.secondsRemaining / 60)\n      }));\n      return;\n    } // Manual sync is available, clear info message\n\n\n    onInfo();\n  }, [state.secondsRemaining, state.readyForManualSync, state.coolDownSeconds, state.showCountdown, onInfo]);\n\n  const scheduleSync = () => {\n    dispatch({\n      type: 'SCHEDULE'\n    });\n    Object(_canvas_do_fetch_api_effect__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n      method: 'POST',\n      path: `/api/v1/courses/${courseId}/microsoft_sync/schedule_sync`\n    }).then(response => {\n      dispatch({\n        type: 'SCHEDULE_SUCCESS',\n        payload: {\n          group: response.json\n        }\n      });\n    }).catch(e => dispatch({\n      type: 'SCHEDULE_FAILED',\n      payload: {\n        error: e.message\n      }\n    }));\n  };\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_buttons__WEBPACK_IMPORTED_MODULE_5__[\"Button\"], {\n    withBackground: false,\n    color: \"primary\",\n    margin: \"none small none none\",\n    interaction: state.enabled && !state.loading && (state.secondsRemaining <= 0 || !state.showCountdown) ? 'enabled' : 'disabled',\n    onClick: scheduleSync,\n    display: \"block\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_6__[\"View\"], {\n    display: \"block\",\n    height: \"20px\"\n  }, state.loading ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__[\"Spinner\"], {\n    renderTitle: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Scheduling sync'),\n    size: \"x-small\"\n  }) : i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync Now')));\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (MicrosoftSyncButton);\n\n//# sourceURL=webpack:///./ui/shared/integrations/react/courses/microsoft_sync/MicrosoftSyncButton.js?");

/***/ }),

/***/ "EqWr":
/*!****************************************************************************!*\
  !*** ./ui/shared/integrations/react/courses/microsoft_sync/useSettings.js ***!
  \****************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ \"ODXe\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"vDqi\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var i18n_course_settings__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! i18n!course_settings */ \"3n31\");\n/* harmony import */ var _canvas_use_fetch_api_hook__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @canvas/use-fetch-api-hook */ \"yoUd\");\n\n\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\nfunction useSettings(courseId) {\n  const _useState = Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useState\"])({}),\n        _useState2 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState, 2),\n        group = _useState2[0],\n        setGroup = _useState2[1];\n\n  const _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useState\"])(false),\n        _useState4 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState3, 2),\n        enabled = _useState4[0],\n        setEnabled = _useState4[1];\n\n  const _useState5 = Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useState\"])(false),\n        _useState6 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState5, 2),\n        loading = _useState6[0],\n        setLoading = _useState6[1];\n\n  const _useState7 = Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useState\"])(),\n        _useState8 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState7, 2),\n        error = _useState8[0],\n        setError = _useState8[1];\n\n  const groupEndpoint = `/api/v1/courses/${courseId}/microsoft_sync/group`;\n\n  async function toggleGroup() {\n    const response = await axios__WEBPACK_IMPORTED_MODULE_1___default.a.request({\n      method: enabled ? 'delete' : 'post',\n      url: groupEndpoint\n    });\n    setGroup(response.data);\n    setEnabled(!!response.data.workflow_state);\n    setError();\n  } // This effect is called once on render\n\n\n  Object(_canvas_use_fetch_api_hook__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({\n    success: Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useCallback\"])(response => {\n      setGroup(response);\n      setEnabled(!!response.workflow_state);\n\n      if (response.workflow_state === 'errored') {\n        let message = i18n_course_settings__WEBPACK_IMPORTED_MODULE_3__[\"default\"].t('An error occurred during the sync process: %{error}', {\n          error: response.last_error\n        });\n\n        if (response.last_error_report_id) {\n          message = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_2___default.a.createElement(\"a\", {\n            href: `/error_reports/${response.last_error_report_id}`\n          }, message);\n        }\n\n        setError({\n          message\n        });\n      }\n    }, []),\n    error: Object(react__WEBPACK_IMPORTED_MODULE_2__[\"useCallback\"])(e => {\n      // 404s are expected if the group has not been created yet.\n      if (!(e.response.status === 404)) {\n        setError(e.message);\n      }\n    }, []),\n    loading: setLoading,\n    path: groupEndpoint\n  }); // The function called to enable/disable\n  // Microsoft Sync plugin\n\n  async function toggleEnabled() {\n    setLoading(true);\n\n    try {\n      await toggleGroup();\n    } catch (e) {\n      let message;\n\n      try {\n        message = e.response.data.message;\n      } catch (e) {\n        message = null;\n      }\n\n      setError(message ? {\n        message\n      } : e.message);\n    }\n\n    setLoading(false);\n  }\n\n  return [group, enabled, loading, error, toggleEnabled, setError, setGroup];\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (useSettings);\n\n//# sourceURL=webpack:///./ui/shared/integrations/react/courses/microsoft_sync/useSettings.js?");

/***/ }),

/***/ "Xb1H":
/*!******************************************************************************!*\
  !*** ./ui/shared/integrations/react/courses/microsoft_sync/MicrosoftSync.js ***!
  \******************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"ouhR\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _canvas_datetime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @canvas/datetime */ \"7AEQ\");\n/* harmony import */ var i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18n!course_settings */ \"3n31\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-spinner */ \"cPO5\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/* harmony import */ var _instructure_ui_list__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-list */ \"dbzd\");\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\nconst stateMap = {\n  pending: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Ready for sync'),\n  scheduled: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync auto-scheduled by enrollment changes'),\n  manually_scheduled: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync manually scheduled'),\n  running: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync currently running'),\n  retrying: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync currently running'),\n  errored: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('The sync encountered an error and did not complete'),\n  completed: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync completed successfully'),\n  deleted: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync not enabled')\n};\n\nconst MicrosoftSync = ({\n  group,\n  loading,\n  children\n}) => {\n  if (loading) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_7__[\"View\"], {\n      as: \"div\",\n      textAlign: \"center\"\n    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_5__[\"Spinner\"], {\n      renderTitle: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Loading Microsoft sync data')\n    }));\n  }\n\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_3___default.a.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], null, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Sync and Provision Microsoft Teams with your Canvas Course')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(\"br\", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], null, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Note: Syncing is triggered by changes to course enrollments. The first time you enable Microsoft Sync, you may have to trigger a sync manually with the button below.')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"], {\n    margin: \"small 0 0 0\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, {\n    size: \"8rem\",\n    margin: \"0 medium 0 0\"\n  }, children), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_8__[\"InlineList\"], {\n    delimiter: \"pipe\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_8__[\"InlineList\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], {\n    weight: \"bold\"\n  }, \"Status:\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], {\n    fontStyle: \"italic\"\n  }, \" \", stateMap[group.workflow_state])), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_8__[\"InlineList\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], {\n    weight: \"bold\"\n  }, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Last Sync:')), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_6__[\"Text\"], {\n    fontStyle: \"italic\"\n  }, ' ', jquery__WEBPACK_IMPORTED_MODULE_0___default.a.datetimeString(group.last_synced_at) || i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('never'))), group.workflow_state !== 'errored' && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default.a.createElement(_instructure_ui_list__WEBPACK_IMPORTED_MODULE_8__[\"InlineList\"].Item, null, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('No errors'))))));\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (MicrosoftSync);\n\n//# sourceURL=webpack:///./ui/shared/integrations/react/courses/microsoft_sync/MicrosoftSync.js?");

/***/ }),

/***/ "vAIG":
/*!****************************************************************!*\
  !*** ./ui/shared/integrations/react/courses/IntegrationRow.js ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! i18n!course_settings */ \"3n31\");\n/* harmony import */ var _instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @instructure/ui-alerts */ \"spba\");\n/* harmony import */ var _instructure_ui_checkbox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-checkbox */ \"Kdwl\");\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_icons__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-icons */ \"oMAr\");\n/* harmony import */ var _instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @instructure/ui-a11y-content */ \"9+/z\");\n/* harmony import */ var _instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @instructure/ui-spinner */ \"cPO5\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_toggle_details__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @instructure/ui-toggle-details */ \"Bcfm\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\n\n\nconst IntegrationRow = ({\n  available,\n  children,\n  enabled,\n  error,\n  expanded,\n  info,\n  loading,\n  name,\n  onChange,\n  onToggle\n}) => {\n  const summary = () => /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"], {\n    justifyItems: \"space-between\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__[\"Text\"], null, name), error && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_10__[\"View\"], null, \"\\xA0\", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_icons__WEBPACK_IMPORTED_MODULE_5__[\"IconWarningLine\"], {\n    color: \"error\",\n    title: i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('Integration error')\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, loading && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_10__[\"View\"], {\n    as: \"div\",\n    textAlign: \"center\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_spinner__WEBPACK_IMPORTED_MODULE_7__[\"Spinner\"], {\n    margin: \"none medium none none\",\n    size: \"x-small\",\n    renderTitle: i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('Loading %{name} data', {\n      name\n    })\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_4__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_checkbox__WEBPACK_IMPORTED_MODULE_3__[\"Checkbox\"], {\n    label: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_a11y_content__WEBPACK_IMPORTED_MODULE_6__[\"ScreenReaderContent\"], null, i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('Toggle %{name}', {\n      name\n    })),\n    variant: \"toggle\",\n    checked: enabled,\n    onChange: onChange,\n    disabled: loading\n  })))));\n\n  const toggleLabel = () => expanded ? i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('Hide %{name} details', {\n    name\n  }) : i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('Show %{name} details', {\n    name\n  });\n\n  return available ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_toggle_details__WEBPACK_IMPORTED_MODULE_9__[\"ToggleGroup\"], {\n    toggleLabel: toggleLabel(),\n    summary: summary(),\n    border: false,\n    expanded: expanded,\n    onToggle: onToggle\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n    role: \"region\",\n    \"aria-live\": \"polite\"\n  }, error && !loading && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_2__[\"Alert\"], {\n    variant: \"error\",\n    margin: \"small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__[\"Text\"], null, error.message || i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('An error occurred, please try again. Error: %{error}', {\n    error\n  }))), (!enabled && !loading || info) && (!error || enabled) && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_alerts__WEBPACK_IMPORTED_MODULE_2__[\"Alert\"], {\n    variant: (info === null || info === void 0 ? void 0 : info.variant) || 'info',\n    margin: \"small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_8__[\"Text\"], null, enabled ? (info === null || info === void 0 ? void 0 : info.message) || info : i18n_course_settings__WEBPACK_IMPORTED_MODULE_1__[\"default\"].t('This integration is not enabled. Please enable it to interact with settings.')))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_10__[\"View\"], {\n    display: \"block\",\n    padding: \"small\"\n  }, children))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0___default.a.Fragment, null);\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (IntegrationRow);\n\n//# sourceURL=webpack:///./ui/shared/integrations/react/courses/IntegrationRow.js?");

/***/ }),

/***/ "y0Rl":
/*!**************************************************************!*\
  !*** ./ui/shared/integrations/react/courses/Integrations.js ***!
  \**************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/esm/slicedToArray */ \"ODXe\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! i18n!course_settings */ \"3n31\");\n/* harmony import */ var _instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @instructure/ui-flex */ \"N46v\");\n/* harmony import */ var _instructure_ui_text__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @instructure/ui-text */ \"iE3e\");\n/* harmony import */ var _instructure_ui_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @instructure/ui-view */ \"OkHH\");\n/* harmony import */ var _IntegrationRow__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./IntegrationRow */ \"vAIG\");\n/* harmony import */ var _microsoft_sync_MicrosoftSync__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./microsoft_sync/MicrosoftSync */ \"Xb1H\");\n/* harmony import */ var _microsoft_sync_useSettings__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./microsoft_sync/useSettings */ \"EqWr\");\n/* harmony import */ var _microsoft_sync_MicrosoftSyncButton__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./microsoft_sync/MicrosoftSyncButton */ \"8k+u\");\n\n\n/*\n * Copyright (C) 2021 - present Instructure, Inc.\n *\n * This file is part of Canvas.\n *\n * Canvas is free software: you can redistribute it and/or modify it under\n * the terms of the GNU Affero General Public License as published by the Free\n * Software Foundation, version 3 of the License.\n *\n * Canvas is distributed in the hope that it will be useful, but WITHOUT ANY\n * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR\n * A PARTICULAR PURPOSE. See the GNU Affero General Public License for more\n * details.\n *\n * You should have received a copy of the GNU Affero General Public License along\n * with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n\n\n\n\n\n\n\n\n\nconst Integrations = () => {\n  const _useMicrosoftSettings = Object(_microsoft_sync_useSettings__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(ENV.COURSE_ID),\n        _useMicrosoftSettings2 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useMicrosoftSettings, 7),\n        msGroup = _useMicrosoftSettings2[0],\n        msEnabled = _useMicrosoftSettings2[1],\n        msLoading = _useMicrosoftSettings2[2],\n        msError = _useMicrosoftSettings2[3],\n        msToggleEnabled = _useMicrosoftSettings2[4],\n        setMSError = _useMicrosoftSettings2[5],\n        setMSGroup = _useMicrosoftSettings2[6];\n\n  const _useState = Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useState\"])(!!msError),\n        _useState2 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState, 2),\n        msExpanded = _useState2[0],\n        setMSExpanded = _useState2[1];\n\n  const _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_1__[\"useState\"])(),\n        _useState4 = Object(_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(_useState3, 2),\n        msInfo = _useState4[0],\n        setMSInfo = _useState4[1];\n\n  const anyIntegrationsAvailable = ENV.MSFT_SYNC_ENABLED;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(\"h2\", null, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Integrations')), anyIntegrationsAvailable ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_1___default.a.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_view__WEBPACK_IMPORTED_MODULE_5__[\"View\"], {\n    as: \"div\",\n    borderWidth: \"none none small none\",\n    borderColor: \"primary\",\n    padding: \"none small\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__[\"Flex\"], {\n    justifyItems: \"space-between\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_4__[\"Text\"], {\n    size: \"large\"\n  }, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Feature'))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__[\"Flex\"].Item, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_4__[\"Text\"], {\n    size: \"large\"\n  }, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('State'))))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_IntegrationRow__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n    name: i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('Microsoft Sync'),\n    available: ENV.MSFT_SYNC_ENABLED,\n    enabled: msEnabled,\n    loading: msLoading,\n    onChange: () => {\n      if (!msEnabled) {\n        setMSExpanded(true);\n      }\n\n      msToggleEnabled();\n    },\n    error: msError,\n    info: msInfo,\n    expanded: msExpanded,\n    onToggle: () => setMSExpanded(expanded => !expanded)\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_microsoft_sync_MicrosoftSync__WEBPACK_IMPORTED_MODULE_7__[\"default\"], {\n    group: msGroup,\n    loading: msLoading\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_microsoft_sync_MicrosoftSyncButton__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {\n    courseId: ENV.COURSE_ID,\n    enabled: msEnabled,\n    group: msGroup,\n    error: msError,\n    onError: setMSError,\n    onInfo: setMSInfo,\n    onSuccess: setMSGroup\n  })))) : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__[\"Flex\"], {\n    justifyItems: \"space-around\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_flex__WEBPACK_IMPORTED_MODULE_3__[\"Flex\"].Item, {\n    margin: \"medium 0 0 0\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement(_instructure_ui_text__WEBPACK_IMPORTED_MODULE_4__[\"Text\"], {\n    size: \"x-large\",\n    color: \"secondary\",\n    weight: \"bold\"\n  }, i18n_course_settings__WEBPACK_IMPORTED_MODULE_2__[\"default\"].t('No integrations available')))));\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Integrations);\n\n//# sourceURL=webpack:///./ui/shared/integrations/react/courses/Integrations.js?");

/***/ })

}]);