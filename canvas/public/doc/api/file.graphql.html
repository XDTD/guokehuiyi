<!DOCTYPE html>
<html>
  <head>
    <meta name="Content-Type" content="text/html;charset=UTF-8">
<meta charset="UTF-8">
<title>GraphQL API
 - Canvas LMS REST API Documentation</title>
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />
<link href="css/prettify.css" rel="stylesheet" type="text/css" media="screen" />
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/prettify.js" type="text/javascript"></script>
<script type="text/javascript">
$(function() {
  // set up pretty-printing in static docs generated from .md files
  $('pre.code.bash').addClass('prettyprint language-bash');
  $('pre.code.html').addClass('prettyprint language-html');
  $('pre.code.xml').addClass('prettyprint language-xml');
  $('pre.code.json').addClass('prettyprint language-js');
  $('pre.code.javascript').addClass('prettyprint language-js');
  prettyPrint();
});
</script>

  </head>
  <body>

    <div id="header">
      <h1>
  <a href="index.html">Canvas LMS - REST API and Extensions Documentation</a>
</h1>
    </div>

    <div id="sidebar">
      <nav>
  <h2 class='first'>Basics</h2>
  <a href="" class="current">GraphQL</a>
  <a href="file.changelog.html" class="">API Change Log</a>
  <a href="file.object_ids.html" class="">SIS IDs</a>
  <a href="file.pagination.html" class="">Pagination</a>
  <a href="file.throttling.html" class="">Throttling</a>
  <a href="file.compound_documents.html" class="">Compound Documents</a>
  <a href="file.file_uploads.html" class="">File Uploads</a>
  <a href="file.endpoint_attributes.html" class="">API Endpoint Attributes</a>
  <a href="file.masquerading.html" class="">Masquerading</a>
  <h2>OAuth2</h2>
  <a href="file.oauth.html" class="">OAuth2 Overview</a>
  <a href="file.oauth_endpoints.html" class="">OAuth2 Endpoints</a>
  <a href="file.developer_keys.html" class="">Developer Keys</a>
  <h2>Resources</h2>
  <a  href="all_resources.html">All Resources Reference</a>
  
    
    <a class="" href="api_token_scopes.html">API Token Scopes</a>
  
    
    <a class="" href="account_notifications.html">Account Notifications</a>
  
    
    <a class="" href="account_reports.html">Account Reports</a>
  
    
    <a class="" href="accounts.html">Accounts</a>
  
    
    <a class="" href="accounts_(lti).html">Accounts (LTI)</a>
  
    
    <a class="" href="admins.html">Admins</a>
  
    
    <a class="" href="announcement_external_feeds.html">Announcement External Feeds</a>
  
    
    <a class="" href="announcements.html">Announcements</a>
  
    
    <a class="" href="appointment_groups.html">Appointment Groups</a>
  
    
    <a class="" href="assignment_extensions.html">Assignment Extensions</a>
  
    
    <a class="" href="assignment_groups.html">Assignment Groups</a>
  
    
    <a class="" href="assignments.html">Assignments</a>
  
    
    <a class="" href="authentication_providers.html">Authentication Providers</a>
  
    
    <a class="" href="authentications_log.html">Authentications Log</a>
  
    
    <a class="" href="blueprint_courses.html">Blueprint Courses</a>
  
    
    <a class="" href="bookmarks.html">Bookmarks</a>
  
    
    <a class="" href="brand_configs.html">Brand Configs</a>
  
    
    <a class="" href="calendar_events.html">Calendar Events</a>
  
    
    <a class="" href="collaborations.html">Collaborations</a>
  
    
    <a class="" href="comm_messages.html">CommMessages</a>
  
    
    <a class="" href="communication_channels.html">Communication Channels</a>
  
    
    <a class="" href="conferences.html">Conferences</a>
  
    
    <a class="" href="content_exports.html">Content Exports</a>
  
    
    <a class="" href="content_migrations.html">Content Migrations</a>
  
    
    <a class="" href="content_security_policy_settings.html">Content Security Policy Settings</a>
  
    
    <a class="" href="content_shares.html">Content Shares</a>
  
    
    <a class="" href="conversations.html">Conversations</a>
  
    
    <a class="" href="course_audit_log.html">Course Audit log</a>
  
    
    <a class="" href="course_quiz_extensions.html">Course Quiz Extensions</a>
  
    
    <a class="" href="courses.html">Courses</a>
  
    
    <a class="" href="custom_gradebook_columns.html">Custom Gradebook Columns</a>
  
    
    <a class="" href="discussion_topics.html">Discussion Topics</a>
  
    
    <a class="" href="enrollment_terms.html">Enrollment Terms</a>
  
    
    <a class="" href="enrollments.html">Enrollments</a>
  
    
    <a class="" href="error_reports.html">Error Reports</a>
  
    
    <a class="" href="external_tools.html">External Tools</a>
  
    
    <a class="" href="favorites.html">Favorites</a>
  
    
    <a class="" href="feature_flags.html">Feature Flags</a>
  
    
    <a class="" href="files.html">Files</a>
  
    
    <a class="" href="grade_change_log.html">Grade Change Log</a>
  
    
    <a class="" href="gradebook_history.html">Gradebook History</a>
  
    
    <a class="" href="grading_periods.html">Grading Periods</a>
  
    
    <a class="" href="grading_standards.html">Grading Standards</a>
  
    
    <a class="" href="group_categories.html">Group Categories</a>
  
    
    <a class="" href="groups.html">Groups</a>
  
    
    <a class="" href="history.html">History</a>
  
    
    <a class="" href="image_search.html">Image Search</a>
  
    
    <a class="" href="immersive_reader.html">Immersive Reader</a>
  
    
    <a class="" href="inst_access_tokens.html">InstAccess tokens</a>
  
    
    <a class="" href="jw_ts.html">JWTs</a>
  
    
    <a class="" href="late_policy.html">Late Policy</a>
  
    
    <a class="" href="line_items.html">Line Items</a>
  
    
    <a class="" href="live_assessments.html">LiveAssessments</a>
  
    
    <a class="" href="logins.html">Logins</a>
  
    
    <a class="" href="media_objects.html">Media Objects</a>
  
    
    <a class="" href="moderated_grading.html">Moderated Grading</a>
  
    
    <a class="" href="modules.html">Modules</a>
  
    
    <a class="" href="names_and_role.html">Names and Role</a>
  
    
    <a class="" href="notification_preferences.html">Notification Preferences</a>
  
    
    <a class="" href="originality_reports.html">Originality Reports</a>
  
    
    <a class="" href="outcome_groups.html">Outcome Groups</a>
  
    
    <a class="" href="outcome_imports.html">Outcome Imports</a>
  
    
    <a class="" href="outcome_results.html">Outcome Results</a>
  
    
    <a class="" href="outcomes.html">Outcomes</a>
  
    
    <a class="" href="pages.html">Pages</a>
  
    
    <a class="" href="peer_reviews.html">Peer Reviews</a>
  
    
    
    
    
    <a class="" href="planner.html">Planner</a>
  
    
    <a class="" href="poll_sessions.html">Poll Sessions</a>
  
    
    <a class="" href="poll_choices.html">PollChoices</a>
  
    
    <a class="" href="poll_submissions.html">PollSubmissions</a>
  
    
    <a class="" href="polls.html">Polls</a>
  
    
    <a class="" href="proficiency_ratings.html">Proficiency Ratings</a>
  
    
    <a class="" href="progress.html">Progress</a>
  
    
    <a class="" href="public_jwk.html">Public JWK</a>
  
    
    <a class="" href="quiz_assignment_overrides.html">Quiz Assignment Overrides</a>
  
    
    <a class="" href="quiz_extensions.html">Quiz Extensions</a>
  
    
    <a class="" href="quiz_ip_filters.html">Quiz IP Filters</a>
  
    
    <a class="" href="quiz_question_groups.html">Quiz Question Groups</a>
  
    
    <a class="" href="quiz_questions.html">Quiz Questions</a>
  
    
    <a class="" href="quiz_reports.html">Quiz Reports</a>
  
    
    <a class="" href="quiz_statistics.html">Quiz Statistics</a>
  
    
    <a class="" href="quiz_submission_events.html">Quiz Submission Events</a>
  
    
    <a class="" href="quiz_submission_files.html">Quiz Submission Files</a>
  
    
    <a class="" href="quiz_submission_questions.html">Quiz Submission Questions</a>
  
    
    <a class="" href="quiz_submission_user_list.html">Quiz Submission User List</a>
  
    
    <a class="" href="quiz_submissions.html">Quiz Submissions</a>
  
    
    <a class="" href="quizzes.html">Quizzes</a>
  
    
    <a class="" href="result.html">Result</a>
  
    
    <a class="" href="roles.html">Roles</a>
  
    
    <a class="" href="rubrics.html">Rubrics</a>
  
    
    <a class="" href="sis_import_errors.html">SIS Import Errors</a>
  
    
    <a class="" href="sis_imports.html">SIS Imports</a>
  
    
    <a class="" href="sis_integration.html">SIS Integration</a>
  
    
    <a class="" href="score.html">Score</a>
  
    
    <a class="" href="search.html">Search</a>
  
    
    <a class="" href="sections.html">Sections</a>
  
    
    <a class="" href="services.html">Services</a>
  
    
    <a class="" href="shared_brand_configs.html">Shared Brand Configs</a>
  
    
    <a class="" href="submission_comments.html">Submission Comments</a>
  
    
    <a class="" href="submissions.html">Submissions</a>
  
    
    <a class="" href="tabs.html">Tabs</a>
  
    
    <a class="" href="user_observees.html">User Observees</a>
  
    
    <a class="" href="users.html">Users</a>
  
    
    
    <a class="" href="e_pub_exports.html">ePub Exports</a>
  
  <h2>Outcomes</h2>
  <a href="file.outcomes_csv.html" class="">Outcomes CSV Format</a>
  <h2>Group Categories</h2>
  <a href="file.group_category_csv.html" class="">Group Categories CSV Format</a>
  <h2>SIS</h2>
  <a href="file.sis_csv.html" class="">SIS CSV Format</a>
  <h2>External Tools</h2>
  <td>
    <li><h4>LTI</h4>
      <a href="file.tools_intro.html" class="">Introduction</a>
      <a href="file.lti_dev_key_config.html" class="">Configuring</a>
      <a href="file.tools_variable_substitutions.html" class="">Variable Substitutions</a>
      <a href="file.content_item.html" class="">Deep Linking</a>
      <a href="file.assignment_tools.html" class="">Grading</a>
      <a href="file.provisioning.html" class="">Provisioning</a>
      <a href="file.lti_window_post_message.html" class="">window.PostMessage</a>
        <ul><h4>Placements</h4>
                <a href="file.navigation_tools.html" class="">Navigation</a>
                <a href="file.homework_submission_placement.html" class="">Homework Submission</a>
                <a href="file.editor_button_placement.html" class="">Editor Button</a>
                <a href="file.migration_selection_placement.html" class="">Migration Selection</a>
                <a href="file.link_selection_placement.html" class="">Link Selection (Modules)</a>
                <a href="file.assignment_selection_placement.html" class="">Assignment Selection</a>
                <a href="file.collaborations_placement.html" class="">Collaborations</a>
        </ul >
      <a href="file.xapi.html" class="">xAPI</a>
    </li >
    <li><h4>Plagiarism Detection Platform</h4>
      <a href="file.plagiarism_platform.html" class="">Overview</a>
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <a class="" href="plagiarism_detection_platform_assignments.html">Plagiarism Detection Platform Assignments</a>
      
        
        <a class="" href="plagiarism_detection_platform_users.html">Plagiarism Detection Platform Users</a>
      
        
        <a class="" href="plagiarism_detection_submissions.html">Plagiarism Detection Submissions</a>
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <a class="" href="webhooks_subscriptions_for_plagiarism_platform.html">Webhooks Subscriptions for Plagiarism Platform</a>
      
        
      <a href="file.jwt_access_tokens.html" class="">JWT Access Tokens</a>
    </li >
  </td>
  <h2>Data Services</h2>
  <td>
    <li>
      <h4>Live Events</h4>
      <ul>
        <h4>Overview</h4>
        <a href="file.data_service_introduction.html" class="">Introduction</a>
        <a href="file.data_service_setup.html" class="">Setup</a>
        <a href="file.data_service_canvas_event_metadata.html" class="">Metadata</a>
      </ul>

      <ul>
        <h4>Event Format</h4>
        <li>
          <h4>Canvas</h4>
          
            <a href="file.data_service_canvas_account.html" class="">Account</a>
          
            <a href="file.data_service_canvas_asset.html" class="">Asset</a>
          
            <a href="file.data_service_canvas_assignment.html" class="">Assignment</a>
          
            <a href="file.data_service_canvas_attachment.html" class="">Attachment</a>
          
            <a href="file.data_service_canvas_content.html" class="">Content</a>
          
            <a href="file.data_service_canvas_conversation.html" class="">Conversation</a>
          
            <a href="file.data_service_canvas_course.html" class="">Course</a>
          
            <a href="file.data_service_canvas_discussion.html" class="">Discussion</a>
          
            <a href="file.data_service_canvas_enrollment.html" class="">Enrollment</a>
          
            <a href="file.data_service_canvas_grade.html" class="">Grade</a>
          
            <a href="file.data_service_canvas_group.html" class="">Group</a>
          
            <a href="file.data_service_canvas_learning.html" class="">Learning</a>
          
            <a href="file.data_service_canvas_logged.html" class="">Logged</a>
          
            <a href="file.data_service_canvas_module.html" class="">Module</a>
          
            <a href="file.data_service_canvas_outcome.html" class="">Outcome</a>
          
            <a href="file.data_service_canvas_plagiarism.html" class="">Plagiarism</a>
          
            <a href="file.data_service_canvas_quiz.html" class="">Quiz</a>
          
            <a href="file.data_service_canvas_sis.html" class="">Sis</a>
          
            <a href="file.data_service_canvas_submission.html" class="">Submission</a>
          
            <a href="file.data_service_canvas_syllabus.html" class="">Syllabus</a>
          
            <a href="file.data_service_canvas_user.html" class="">User</a>
          
            <a href="file.data_service_canvas_wiki.html" class="">Wiki</a>
          
        </li>
        <li>
          <h4>Caliper IMS 1.1</h4>
          
            <a href="file.data_service_caliper_assessment.html" class="">Assessment</a>
          
            <a href="file.data_service_caliper_basic.html" class="">Basic</a>
          
            <a href="file.data_service_caliper_forum.html" class="">Forum</a>
          
            <a href="file.data_service_caliper_grading.html" class="">Grading</a>
          
            <a href="file.data_service_caliper_navigation_events.html" class="">Navigation Events</a>
          
            <a href="file.data_service_caliper_session.html" class="">Session</a>
          
        </li>
      </ul>
    </li>
  </td>
</nav>

    </div>

    <div id="content"><div id='filecontents'><h1 id="graphql-api">GraphQL API</h1>

<h2 id="graphql-introduction">GraphQL Introduction</h2>

<p>GraphQL is a query API language that executes queries by using a type system
based on defined input data. GraphQL provides more specific inquiries with
faster results and populate multiple inputs into one query.</p>

<p>Note: GraphQL endpoint permissions mirror permissions for the REST API. A
user is only granted access to view grades based on that user’s permissions.
For instance, a student cannot view grades for another student, but an
instructor can view grades for any student in a course.</p>

<p><a href="https://graphql.org/learn/">Learn more about GraphQL</a>.</p>

<h2 id="using-graphql">Using GraphQL</h2>

<p>Canvas has included the tool GraphiQL (<a href="https://github.com/graphql/graphiql">https://github.com/graphql/graphiql</a>), an
in-browser graphical interface for interacting with GraphQL endpoints.</p>

<p>The GraphiQL interface can be viewed by adding /graphiql to the end of your
Canvas production URL (e.g. your-institution.instructure.com/graphiql).</p>

<p>The /graphiql access can also be added to a test or beta environment URL.
Requests from the selected environment will always return that environment’s
data.</p>

<p>The Explorer sidebar displays all available queries and mutations. Any selected
items display in the GraphiQL window. Once a query or mutation is selected, any
values displayed in purple text identify the value as an input argument.</p>

<h3 id="rest-vs-graphql">REST vs GraphQL</h3>

<p>The Canvas REST API will continue to be available.  New Canvas features will be
developed primarily in GraphQL and may not be back-ported to the REST API.</p>

<p>Fields are being added to the GraphQL API on an as-needed basis.  The GraphQL
API does not include everything that is currently in the REST API.  Feel free
to submit pull requests on github to add additional features or talk about it
in the <code>#canvas-lms</code> channel on libera.chat.</p>

<h2 id="graphql-endpoint">GraphQL Endpoint</h2>

<div class="method_details">
  <h3 class="endpoint">POST /api/graphql</h3>
</div>

<p>All GraphQL queries are posted to this endpoint.</p>

<h4 id="request-parameters">Request Parameters</h4>

<table class="request-params">
  <tr>
    <th class="param-name">Parameter</th>
    <th class="param-req"></th>
    <th class="param-type">Type</th>
    <th class="param-desc">Description</th>
  </tr>
  <tr class="request-param">
    <td>query</td>
    <td></td>
    <td>string</td>
    <td>the GraphQL query to execute</td>
  </tr>
  <tr class="request-param">
    <td>variables</td>
    <td></td>
    <td>Hash</td>
    <td>variable values as required by the supplied query</td>
  </tr>
</table>

<h4 id="example-request">Example Request:</h4>

<pre class="code bash"><code class="bash">curl https://&lt;canvas&gt;/api/graphql \
  -H &#39;Authorization: Bearer &lt;ACCESS_TOKEN&gt;&#39; \
  -d query=&#39;query courseInfo($courseId: ID!) {
       course(id: $courseId) {
        id
        _id
        name
       }
     }&#39; \
  -d variables[courseId]=1
</code></pre>

<h4 id="example-response">Example Response</h4>

<pre class="code js"><code class="js">{
  &quot;data&quot;: {
    &quot;course&quot;: {
      &quot;id&quot;: &quot;Q291cnNlLTE=&quot;,
      &quot;_id&quot;: &quot;1&quot;,
      &quot;name&quot;: &quot;Mr. Ratburn&#39;s Class&quot;
    }
  }
}
</code></pre>

<h2 id="graphql-in-canvas">GraphQL in Canvas</h2>

<h3 id="id-vs-_id-and-the-node-field"><code>id</code> vs <code>_id</code> and the <code>node</code> field</h3>

<p>The Canvas LMS GraphQL API follows the <a href="https://relay.dev/graphql/objectidentification.htm">Relay Object Identification
spec</a>.
Querying for an object&#39;s <code>id</code> will return a global identifier instead of the
numeric ids that are used in the REST API.  The traditional ids can be queried
by requesting the <code>_id</code> field.</p>

<p>Most objects can be fetched by passing their  GraphQL  <code>id</code> to the
<code>node</code> field:</p>

<pre class="code graphql"><code class="graphql">{
  node(id: &quot;Q291cnNlLTE=&quot;) {
    ... on Course {
      _id  #  traditional ids (e.g. &quot;1&quot;)
      name
      term { name }
    }
  }
}
</code></pre>

<p>A <code>legacyNode</code> field is also available to fetch objects via the
REST-style ids:</p>

<pre class="code"><code class="">{
  # object type must be specified when using legacyNode
  legacyNode(type: Course, _id: &quot;1&quot;) {
    ... on Course {
      _id
      name
    }
  }
}
</code></pre>

<p>For commonly accessed object types, type-specific fields are provided:</p>

<pre class="code"><code class="">{
  # NOTE: id arguments will always take either GraphQL or rest-style ids
  c1: course(id: &quot;1&quot;) {
    _id
    name
  }
  c2: course(id: &quot;Q291cnNlLTE=&quot;) {
    _id
    name
  }
}
</code></pre>

<h3 id="pagination">Pagination</h3>

<p>Canvas follows the <a href="https://facebook.github.io/relay/graphql/connections.htm">Relay Connection
Spec</a>
for paginating collections.  Request reasonable page sizes to avoid
being limited.</p>

<pre class="code"><code class="">{
  course(id: &quot;1&quot;) {
    assignmentsConnection(
      first: 10,      # page size
      after: &quot;XYZ&quot;    # `endCursor` from previous page
    ) {
      nodes {
        id
        name
      }
      pageInfo {
        endCursor     # this is your `after` value for the next request
        hasNextPage
      }
    }
  }
}
</code></pre>

<h2 id="canvas-api-gateway">Canvas API Gateway</h2>

<p>It&#39;s not ONLY Canvas that is using GraphQL as it&#39;s primary API protocol
at Instructure.  All Canvas services with public-facing APIs are
moving (slowly) towards federating their APIs through a single <a href="https://community.canvaslms.com/t5/The-Product-Blog/From-the-Engineering-Deck-Instructure-amp-GraphQL/ba-p/477314">GraphQL gateway</a>.</p>

<p>This means that in the future you can access your data from multiple Instructure properties 
beyond Canvas at a single entrypoint, with a single auth pattern, and even in a single request.<br>
If this idea is entirely foreign to you, you can learn more about this kind of
API gateway in the docs of our tooling vendor, <a href="https://www.apollographql.com/docs/federation/">Apollo</a>.</p>

<h3 id="how-do-i-connect-to-the-api-gateway">How do I connect to the API gateway?</h3>

<p>You can interact with the API gateway in any browser directly,
similar to the Graphiql interface in Canvas proper.  Start
by visiting the API URL that matches your Canvas domain.</p>

<p>For example, if your institution uses &quot;abcd.instructure.com&quot; to
interact with Canvas,
you could visit the gateway at &quot;<a href="https://abcd.api.instructure.com/graphql">https://abcd.api.instructure.com/graphql</a>&quot;</p>

<p>This will take you to a GraphQL playground interface,
but you&#39;ll quickly realize you can&#39;t do anything because
the API still needs to know who you are.  Your interface
will have an error message that says something like:</p>

<pre class="code json"><code class="json">{
  &quot;error&quot;: &quot;Response not successful: Received status code 400&quot;
}
</code></pre>

<p>To use the interface fully, you&#39;ll need an Instructure Access Token,
which you can receive from the standard Canvas API.  In order to retrieve
a fresh &quot;Instructure Access Token&quot;, you&#39;ll have to use your <a href="https://canvas.instructure.com/doc/api/file.oauth.html#accessing-canvas-api">&quot;Canvas Access Token&quot;</a>.
Yes, it&#39;s slightly confusing, we&#39;re thinking about better names.</p>

<pre class="code bash"><code class="bash">curl &#39;https://&lt;YOUR_CANVAS_DOMAIN&gt;/api/v1/inst_access_tokens&#39; \
  -X POST \
  -H &quot;Accept: application/json&quot; \
  -H &#39;Authorization: Bearer &lt;YOUR_CANVAS_ACCESS_TOKEN&gt;&#39;
</code></pre>

<p>You should get a JSON response that contains a lengthy JWT for you:</p>

<pre class="code json"><code class="json">{
  &quot;token&quot;: &quot;&lt;your-whole-inst-access-token-which-will-be-a-string-much-longer-than-this&gt;&quot;
}
</code></pre>

<p>That token is temporary (it will expire after an hour), and cannot be used directly against Canvas.
It&#39;s only useful as an access token for talking to an API gateway endpoint.  However,
any Canvas GraphQL query you might make can be made through the gateway with one of these
access tokens.</p>

<p>You can prove to yourself that this new token is valid by executing a simple query
against the API gateway directly (you can use the regional access URL of your choice):</p>

<pre class="code bash"><code class="bash">curl &#39;https://&lt;your-subdomain&gt;.api.instructure.com/graphql&#39; \
  -H &#39;Content-Type: application/json&#39; \
  -H &#39;Accept: application/json&#39; \
  -H &#39;Authorization: Bearer &lt;your-inst-access-token&gt;&#39; \
  --data-binary &#39;{&quot;query&quot;:&quot;{ whoami { userUuid } }&quot;}&#39; --compressed
</code></pre>

<p>If you used the InstAccessToken correctly, you&#39;ll get a simple response including the UUID of
the user that created this token:</p>

<pre class="code json"><code class="json">{
  &quot;data&quot;: {
    &quot;whoami&quot;: {
      &quot;userUuid&quot;:&quot;&lt;your-user-uuid&gt;&quot;
    }
  }
}
</code></pre>

<p>If you go back to your browser, which you previously pointed at one of the API
gateway endpoints, look in the lower left of the screen to find the
&quot;HTTP Headers&quot; panel.  Here you can put in your Instructure Access Token into
the authorization header by entering a JSON document that looks like:</p>

<pre class="code json"><code class="json">{
  &quot;Authorization&quot;: &quot;Bearer &lt;your-inst-access-token&gt;&quot;
}
</code></pre>

<p>Now you should be able to author any GraphQL query you want
in the editor on the left side, and see the results displayed on the right side when
you hit the play button.  Try some of these queries:</p>

<p>Simple Hello World</p>

<pre class="code gql"><code class="gql">{ hello }
</code></pre>

<p>Response:</p>

<pre class="code json"><code class="json">{
  &quot;data&quot;: {
    &quot;hello&quot;: &quot;Hello world!&quot;
  }
}
</code></pre>

<p>Two queries at once, one that tells you which user you are.</p>

<pre class="code gql"><code class="gql">{
  hello
  whoami {
    userUuid
  }
}
</code></pre>

<p>Response:</p>

<pre class="code json"><code class="json">{
  &quot;data&quot;: {
    &quot;hello&quot;: &quot;Hello world!&quot;,
    &quot;whoami&quot;: {
      &quot;userUuid&quot;: &quot;&lt;your-user-uuid&gt;&quot;
    }
  }
}
</code></pre>

<p>Two SERVICES at once, (the &quot;account&quot; entrypoint
is substantiated by Canvas, the other 2 are test entrypoints
provided by a different backend).  This is the shape of the idea for
interacting with systems like &quot;New Quizzes&quot;.</p>

<pre class="code gql"><code class="gql">{
  hello
  whoami {
    userUuid
  }
  account(id: &lt;your-account-id&gt;){
    id
    name
    sisId
  }
}
</code></pre>

<p>Response:</p>

<pre class="code json"><code class="json">{
  &quot;data&quot;: {
    &quot;hello&quot;: &quot;Hello world!&quot;,
    &quot;whoami&quot;: {
      &quot;userUuid&quot;: &quot;&lt;your-user-uuid&gt;&quot;
    },
    &quot;account&quot;: {
      &quot;id&quot;: &quot;&lt;account-uuid&gt;&quot;,
      &quot;name&quot;: &quot;&lt;account-name&gt;&quot;,
      &quot;sisId&quot;: &quot;&lt;sis-id&gt;&quot;
    }
  }
}
</code></pre>

<h4 id="fcqs-frequently-confusing-queries">FCQs (frequently confusing queries)</h4>

<h5 id="is-there-any-advantage-to-me-in-using-the-gateway-rather-than-the-canvas-graphql-endpoint-directly">Is there any advantage to me in using the gateway rather than the Canvas  GraphQL  endpoint directly?</h5>

<p>Not really, if you&#39;re just loading data from Canvas itself.  In the future, if you&#39;re interacting
with New Quizzes or other ancillary services, there will be graph entries present in the gateway
schema for those services that are NOT available through Canvas directly, so for those
cases using the gateway gives you access to a wider set of api endpoints.</p>

<h5 id="why-cant-i-just-use-my-canvas-access-token-against-the-gateway">Why can&#39;t I just use my Canvas access token against the gateway?</h5>

<p>Your Canvas access tokens are long lived and give access to everything,
plus Canvas has to hear about them to confirm with the database what user
 they&#39;re attached to.  Instructure Access Tokens contain cryptographically signed payloads that
 any Instructure service (like new quizzes) can read to confirm who you are without
 having to consult Canvas (which helps avoid performance bottlenecks).  They also
 only are valid for a short time, so handing them around the network is less risky
 from a security standpoint.</p>

<h5 id="what-should-i-do-if-my-instructure-access-token-stops-working">What should I do if my Instructure Access Token stops working</h5>

<p>They&#39;re designed to expire after one hour so the compromise of such a token is
a low-severity event.  Simply request another one from the Canvas
<code>/api/v1/inst_access_tokens</code> endpoint as shown above and keep going.</p>

<p>This implies that API clients should expect to be able to catch &quot;4xx&quot; responses from
the API gateway, recognize their token is expired, and &quot;refresh&quot; it by obtaining a new one.</p>

<h5 id="what-tools-exist-for-helping-me-build-a-graphql-api-client">What tools exist for helping me build a  GraphQL  API client?</h5>

<p>Apollo maintains a <a href="https://graphql.org/code/#javascript-client">list of GraphQL libraries</a> that are
useful for building clients.</p>

<h5 id="will-canvas-the-web-application-use-the-api-gateway">Will Canvas (the web application) use the API Gateway?</h5>

<p>Yes, and it already does.  Canvas uses the &quot;Apollo Client&quot; library
for it&#39;s GraphQL interactions, which in some cases we configure to talk
through the gateway rather than to the Canvas API directly, but for objects
in the Canvas graph the responses are identical.</p>

<p>If you&#39;re running Canvas yourself though, you do not have to use the API gateway,
Canvas clients will continue to talk to the Canvas-provided  GraphQL  endpoint just fine.</p>
</div></div>

    <script type="text/javascript">
  $('h2.api_method_name').each(function(i, el) {
    var subtopic = $(el).data('subtopic');
    var $a = $(el).find('a');
    if ($.trim($a[0].innerHTML) == '')
      return;
    var $row = $('table#quicklinks tr').filter(function() { return $(this).data('subtopic') == subtopic; });
    if ($row.length == 0) {
      $row = $('<tr/>').appendTo($('table#quicklinks'));
      $row.data('subtopic', subtopic);
      $('<th/>').append(subtopic).appendTo($row);
      $('<td/>').appendTo($row);
    }
    var link = $('<a/>').attr('href', '#'+$(el).attr('name')).append($.trim($a[0].innerHTML));
    $row.find('td').append(link);
  });
</script>
<div id="footer">
  &copy; Instructure, Inc. Generated on Thu Dec  2 17:25:06 2021<br>
  This documentation is generated directly from the Canvas LMS source code, available <a href="https://github.com/instructure/canvas-lms">on Github</a>.
</div>

  </body>
</html>
