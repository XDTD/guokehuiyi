"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _chai = require("chai");

var _react = _interopRequireDefault(require("react"));

var _sinon = _interopRequireDefault(require("sinon"));

var _enzyme = require("enzyme");

var _index = _interopRequireDefault(require("../index"));

var _checkA11y = _interopRequireDefault(require("../../../../test/checkA11y"));

var styles = {
  componentId: 'ffgIr',
  template: function template(theme) {
    return "\n\n.outcomes-ui__HeaderDetails--numQuestions {\n  box-sizing: border-box;\n  height: 1.5rem;\n  text-align: left;\n}\n\n[dir=\"ltr\"] .outcomes-ui__HeaderDetails--numQuestions {\n  text-align: left;\n}\n\n[dir=\"rtl\"] .outcomes-ui__HeaderDetails--numQuestions {\n  text-align: left;\n}\n\n.outcomes-ui__HeaderDetails--masteryBarDetails {\n  display: flex;\n  justify-content: space-between;\n}\n";
  },
  'numQuestions': 'outcomes-ui__HeaderDetails--numQuestions',
  'masteryBarDetails': 'outcomes-ui__HeaderDetails--masteryBarDetails'
};
describe('OutcomesPerStudent/HeaderDetails', function () {
  function makeProps(props) {
    return Object.assign({
      outcomeResult: {
        outcome: {
          id: '1',
          label: 'FOO'
        },
        count: 10,
        mastery_count: 5,
        childArtifactCount: 12
      },
      viewReportAlignment: _sinon.default.spy(),
      getReportOutcome: _sinon.default.stub().returns({
        id: '1',
        label: 'FOO',
        title: 'bar'
      }),
      isOpen: false,
      closeReportAlignment: _sinon.default.spy(),
      showRollups: true
    }, props);
  }

  it('includes a progress bar', function () {
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps()), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find('ProgressBar')).to.have.length(1);
  });
  it('hides the progress bar when rollups are hidden', function () {
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps({
      showRollups: false
    })), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find('ProgressBar')).to.have.length(0);
  });
  it('includes the rollup summary', function () {
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps()), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find(".".concat(styles.masteryBarDetails)).find('Text')).to.have.length(2);
  });
  it('hides the rollup summary when rollups are hidden', function () {
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps({
      showRollups: false
    })), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find(".".concat(styles.masteryBarDetails))).to.have.length(0);
  });
  it('does include tooltip', function () {
    var withUsesBank = {
      outcomeResult: {
        outcome: {
          id: '1',
          label: 'FOO'
        },
        count: 10,
        mastery_count: 5,
        childArtifactCount: 12,
        usesBank: true
      }
    };
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps(withUsesBank)), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find('Tooltip')).to.have.length(1);
  });
  it('does not include tooltip', function () {
    var wrapper = (0, _enzyme.shallow)(_react.default.createElement(_index.default, makeProps()), {
      disableLifecycleMethods: true
    });
    (0, _chai.expect)(wrapper.find('Tooltip')).to.have.length(0);
  });
  it('includes the count of aligned items', function () {
    var wrapper = (0, _enzyme.mount)(_react.default.createElement(_index.default, makeProps()));
    (0, _chai.expect)(wrapper.text()).to.match(/12 Questions/);
  });
  it('does not include the count of aligned items if not specified', function () {
    var props = makeProps();
    props.outcomeResult.childArtifactCount = null; // eslint-disable-line immutable/no-mutation

    var wrapper = (0, _enzyme.mount)(_react.default.createElement(_index.default, props));
    (0, _chai.expect)(wrapper.text()).not.to.match(/Questions/);
  });
  it('meets a11y standards', function () {
    return (0, _checkA11y.default)(_react.default.createElement(_index.default, makeProps()));
  });
});