"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("core-js/modules/es.symbol");

require("core-js/modules/es.symbol.description");

require("core-js/modules/es.symbol.async-iterator");

require("core-js/modules/es.symbol.has-instance");

require("core-js/modules/es.symbol.is-concat-spreadable");

require("core-js/modules/es.symbol.iterator");

require("core-js/modules/es.symbol.match");

require("core-js/modules/es.symbol.replace");

require("core-js/modules/es.symbol.search");

require("core-js/modules/es.symbol.species");

require("core-js/modules/es.symbol.split");

require("core-js/modules/es.symbol.to-primitive");

require("core-js/modules/es.symbol.to-string-tag");

require("core-js/modules/es.symbol.unscopables");

require("core-js/modules/es.array.concat");

require("core-js/modules/es.array.copy-within");

require("core-js/modules/es.array.every");

require("core-js/modules/es.array.fill");

require("core-js/modules/es.array.filter");

require("core-js/modules/es.array.find");

require("core-js/modules/es.array.find-index");

require("core-js/modules/es.array.flat");

require("core-js/modules/es.array.flat-map");

require("core-js/modules/es.array.for-each");

require("core-js/modules/es.array.from");

require("core-js/modules/es.array.includes");

require("core-js/modules/es.array.index-of");

require("core-js/modules/es.array.iterator");

require("core-js/modules/es.array.join");

require("core-js/modules/es.array.last-index-of");

require("core-js/modules/es.array.map");

require("core-js/modules/es.array.of");

require("core-js/modules/es.array.reduce");

require("core-js/modules/es.array.reduce-right");

require("core-js/modules/es.array.slice");

require("core-js/modules/es.array.some");

require("core-js/modules/es.array.species");

require("core-js/modules/es.array.splice");

require("core-js/modules/es.array.unscopables.flat");

require("core-js/modules/es.array.unscopables.flat-map");

require("core-js/modules/es.array-buffer.constructor");

require("core-js/modules/es.date.to-primitive");

require("core-js/modules/es.function.has-instance");

require("core-js/modules/es.function.name");

require("core-js/modules/es.json.to-string-tag");

require("core-js/modules/es.map");

require("core-js/modules/es.math.acosh");

require("core-js/modules/es.math.asinh");

require("core-js/modules/es.math.atanh");

require("core-js/modules/es.math.cbrt");

require("core-js/modules/es.math.clz32");

require("core-js/modules/es.math.cosh");

require("core-js/modules/es.math.expm1");

require("core-js/modules/es.math.fround");

require("core-js/modules/es.math.hypot");

require("core-js/modules/es.math.imul");

require("core-js/modules/es.math.log10");

require("core-js/modules/es.math.log1p");

require("core-js/modules/es.math.log2");

require("core-js/modules/es.math.sign");

require("core-js/modules/es.math.sinh");

require("core-js/modules/es.math.tanh");

require("core-js/modules/es.math.to-string-tag");

require("core-js/modules/es.math.trunc");

require("core-js/modules/es.number.constructor");

require("core-js/modules/es.number.epsilon");

require("core-js/modules/es.number.is-finite");

require("core-js/modules/es.number.is-integer");

require("core-js/modules/es.number.is-nan");

require("core-js/modules/es.number.is-safe-integer");

require("core-js/modules/es.number.max-safe-integer");

require("core-js/modules/es.number.min-safe-integer");

require("core-js/modules/es.number.parse-float");

require("core-js/modules/es.number.parse-int");

require("core-js/modules/es.number.to-fixed");

require("core-js/modules/es.object.assign");

require("core-js/modules/es.object.define-getter");

require("core-js/modules/es.object.define-setter");

require("core-js/modules/es.object.entries");

require("core-js/modules/es.object.freeze");

require("core-js/modules/es.object.from-entries");

require("core-js/modules/es.object.get-own-property-descriptor");

require("core-js/modules/es.object.get-own-property-descriptors");

require("core-js/modules/es.object.get-own-property-names");

require("core-js/modules/es.object.get-prototype-of");

require("core-js/modules/es.object.is");

require("core-js/modules/es.object.is-extensible");

require("core-js/modules/es.object.is-frozen");

require("core-js/modules/es.object.is-sealed");

require("core-js/modules/es.object.keys");

require("core-js/modules/es.object.lookup-getter");

require("core-js/modules/es.object.lookup-setter");

require("core-js/modules/es.object.prevent-extensions");

require("core-js/modules/es.object.seal");

require("core-js/modules/es.object.to-string");

require("core-js/modules/es.object.values");

require("core-js/modules/es.promise");

require("core-js/modules/es.promise.finally");

require("core-js/modules/es.reflect.apply");

require("core-js/modules/es.reflect.construct");

require("core-js/modules/es.reflect.define-property");

require("core-js/modules/es.reflect.delete-property");

require("core-js/modules/es.reflect.get");

require("core-js/modules/es.reflect.get-own-property-descriptor");

require("core-js/modules/es.reflect.get-prototype-of");

require("core-js/modules/es.reflect.has");

require("core-js/modules/es.reflect.is-extensible");

require("core-js/modules/es.reflect.own-keys");

require("core-js/modules/es.reflect.prevent-extensions");

require("core-js/modules/es.reflect.set");

require("core-js/modules/es.reflect.set-prototype-of");

require("core-js/modules/es.regexp.constructor");

require("core-js/modules/es.regexp.exec");

require("core-js/modules/es.regexp.flags");

require("core-js/modules/es.regexp.to-string");

require("core-js/modules/es.set");

require("core-js/modules/es.string.code-point-at");

require("core-js/modules/es.string.ends-with");

require("core-js/modules/es.string.from-code-point");

require("core-js/modules/es.string.includes");

require("core-js/modules/es.string.iterator");

require("core-js/modules/es.string.match");

require("core-js/modules/es.string.pad-end");

require("core-js/modules/es.string.pad-start");

require("core-js/modules/es.string.raw");

require("core-js/modules/es.string.repeat");

require("core-js/modules/es.string.replace");

require("core-js/modules/es.string.search");

require("core-js/modules/es.string.split");

require("core-js/modules/es.string.starts-with");

require("core-js/modules/es.string.trim");

require("core-js/modules/es.string.trim-end");

require("core-js/modules/es.string.trim-start");

require("core-js/modules/es.string.anchor");

require("core-js/modules/es.string.big");

require("core-js/modules/es.string.blink");

require("core-js/modules/es.string.bold");

require("core-js/modules/es.string.fixed");

require("core-js/modules/es.string.fontcolor");

require("core-js/modules/es.string.fontsize");

require("core-js/modules/es.string.italics");

require("core-js/modules/es.string.link");

require("core-js/modules/es.string.small");

require("core-js/modules/es.string.strike");

require("core-js/modules/es.string.sub");

require("core-js/modules/es.string.sup");

require("core-js/modules/es.typed-array.float32-array");

require("core-js/modules/es.typed-array.float64-array");

require("core-js/modules/es.typed-array.int8-array");

require("core-js/modules/es.typed-array.int16-array");

require("core-js/modules/es.typed-array.int32-array");

require("core-js/modules/es.typed-array.uint8-array");

require("core-js/modules/es.typed-array.uint8-clamped-array");

require("core-js/modules/es.typed-array.uint16-array");

require("core-js/modules/es.typed-array.uint32-array");

require("core-js/modules/es.typed-array.copy-within");

require("core-js/modules/es.typed-array.every");

require("core-js/modules/es.typed-array.fill");

require("core-js/modules/es.typed-array.filter");

require("core-js/modules/es.typed-array.find");

require("core-js/modules/es.typed-array.find-index");

require("core-js/modules/es.typed-array.for-each");

require("core-js/modules/es.typed-array.from");

require("core-js/modules/es.typed-array.includes");

require("core-js/modules/es.typed-array.index-of");

require("core-js/modules/es.typed-array.iterator");

require("core-js/modules/es.typed-array.join");

require("core-js/modules/es.typed-array.last-index-of");

require("core-js/modules/es.typed-array.map");

require("core-js/modules/es.typed-array.of");

require("core-js/modules/es.typed-array.reduce");

require("core-js/modules/es.typed-array.reduce-right");

require("core-js/modules/es.typed-array.reverse");

require("core-js/modules/es.typed-array.set");

require("core-js/modules/es.typed-array.slice");

require("core-js/modules/es.typed-array.some");

require("core-js/modules/es.typed-array.sort");

require("core-js/modules/es.typed-array.subarray");

require("core-js/modules/es.typed-array.to-locale-string");

require("core-js/modules/es.typed-array.to-string");

require("core-js/modules/es.weak-map");

require("core-js/modules/es.weak-set");

require("core-js/modules/web.dom-collections.for-each");

require("core-js/modules/web.dom-collections.iterator");

require("core-js/modules/web.immediate");

require("core-js/modules/web.queue-microtask");

require("core-js/modules/web.url");

require("core-js/modules/web.url.to-json");

require("core-js/modules/web.url-search-params");

require("regenerator-runtime/runtime");

var _react = _interopRequireDefault(require("react"));

var _reactDom = require("react-dom");

var _lodash = require("lodash");

require("@instructure/canvas-theme");

require("@instructure/canvas-high-contrast-theme");

var _uiAlerts = require("@instructure/ui-alerts");

var _uiHeading = require("@instructure/ui-heading");

var _uiCheckbox = require("@instructure/ui-checkbox");

var _uiSimpleSelect = require("@instructure/ui-simple-select");

var _uiTabs = require("@instructure/ui-tabs");

var _uiThemeable = require("@instructure/ui-themeable");

var _index = require("./index");

var _process, _process$env;

var styles = {
  componentId: 'dCZbw',
  template: function template(theme) {
    return "\n\n* {\n  box-sizing: border-box;\n}\n\nhtml {\n  font-size: 1rem;\n}\n\nhtml, body {\n  margin: 0;\n  height: 100%;\n  font-family: sans-serif;\n}\n\n.outcomes-ui__src--root {\n  background: white;\n  color: black;\n  padding: 2rem;\n  margin: 2rem;\n}\n\n.outcomes-ui__src--item {\n  padding-bottom: 1rem;\n}\n\n.outcomes-ui__src--item > div {\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem;\n  }\n\n.outcomes-ui__src--report {\n  max-width: calc(85vw - 128px);\n}\n\n.outcomes-ui__src--mastery {\n  padding-bottom: 2rem;\n}\n\n#outcomes-ui__src--screenreaderNotifications {\n  height: 1px;\n  width: 1px;\n  clip: rect(0, 0, 0, 0);\n  overflow: hidden;\n}\n";
  },
  'root': 'outcomes-ui__src--root',
  'item': 'outcomes-ui__src--item',
  'report': 'outcomes-ui__src--report',
  'mastery': 'outcomes-ui__src--mastery',
  'screenreaderNotifications': 'outcomes-ui__src--screenreaderNotifications'
};
var themes = ['canvas', 'canvas-high-contrast'];
var root = document.createElement('div');
root.setAttribute('id', 'app');
root.classList.add(styles.root);
document.body.appendChild(root);
var alert = document.createElement('div');
alert.setAttribute('id', 'alert');
document.body.appendChild(alert);

var getLive = function getLive() {
  return document.getElementById('alert-live-region');
};

getLive().setAttribute('role', 'alert');

var screenreaderNotification = function screenreaderNotification(text) {
  (0, _reactDom.render)(_react.default.createElement(_uiAlerts.Alert, {
    screenReaderOnly: true,
    liveRegion: getLive
  }, text), alert);
};

var searchString = window.location.search.slice(1);
var query = (0, _lodash.fromPairs)(searchString.split('&').map(function (kv) {
  return kv.split('=');
}));
var createJwt = query.jwt || process.env.CREATE_TOKEN;
var createKindergartenJwt = query.jwt || process.env.CREATE_KINDERGARTEN_TOKEN;
var createFirstGradeJwt = query.jwt || process.env.CREATE_FIRST_GRADE_TOKEN;
var reportJwt = query.jwt || process.env.REPORT_TOKEN;
var outcomesHost = "http://".concat(query.host || window.location.host);
var _query$artifactType = query.artifactType,
    artifactType = _query$artifactType === void 0 ? 'quizzes.quiz' : _query$artifactType,
    _query$artifactId = query.artifactId,
    artifactId = _query$artifactId === void 0 ? '99' : _query$artifactId;

var DemoAlignment = function DemoAlignment(props) {
  /* eslint-disable no-console, react/prop-types */
  var name = props.name,
      alignmentSetId = props.alignmentSetId,
      artifactType = props.artifactType,
      artifactId = props.artifactId,
      artifactTypeName = props.artifactTypeName,
      contextUuid = props.contextUuid,
      emptySetHeading = props.emptySetHeading,
      displayMasteryDescription = props.displayMasteryDescription,
      displayMasteryPercentText = props.displayMasteryPercentText,
      jwt = props.jwt,
      useAlignmentButton = props.useAlignmentButton;
  return _react.default.createElement("div", {
    className: styles.item,
    "data-automation": "artifact"
  }, _react.default.createElement(_uiHeading.Heading, {
    level: "h3"
  }, name, " \xA0", _react.default.createElement(_index.OutcomeCount, {
    alignmentSetId: alignmentSetId,
    artifactType: artifactType,
    artifactId: artifactId,
    contextUuid: contextUuid,
    host: outcomesHost,
    jwt: jwt
  })), _react.default.createElement(_index.OutcomeList, {
    alignmentSetId: alignmentSetId,
    artifactType: artifactType,
    artifactId: artifactId,
    contextUuid: contextUuid,
    host: outcomesHost,
    jwt: jwt,
    emptyText: "No outcomes are aligned"
  }), useAlignmentButton ? _react.default.createElement("div", null, _react.default.createElement("br", null), _react.default.createElement(_index.AlignmentButton, {
    artifactType: artifactType,
    artifactTypeName: artifactTypeName,
    artifactId: artifactId,
    alignmentSetId: alignmentSetId,
    contextUuid: contextUuid,
    host: outcomesHost,
    jwt: jwt,
    liveRegion: getLive,
    screenreaderNotification: screenreaderNotification,
    readOnly: readOnly === 'true'
  })) : _react.default.createElement(_index.OutcomeAlignments, {
    alignmentSetId: alignmentSetId,
    pickerType: currentPicker,
    contextUuid: contextUuid,
    emptySetHeading: emptySetHeading,
    onUpdate: console.log,
    artifactType: artifactType,
    artifactId: artifactId,
    artifactTypeName: artifactTypeName,
    displayMasteryDescription: displayMasteryDescription,
    displayMasteryPercentText: displayMasteryPercentText,
    host: outcomesHost,
    jwt: jwt,
    screenreaderNotification: screenreaderNotification,
    liveRegion: getLive,
    readOnly: readOnly === 'true'
  }));
};

var currentPicker = 'dialog';
var currentTheme = ((_process = process) === null || _process === void 0 ? void 0 : (_process$env = _process.env) === null || _process$env === void 0 ? void 0 : _process$env.DEFAULT_HIGH_CONTRAST) ? 'canvas-high-contrast' : 'canvas';
var readOnly = 'false';
var currentTab = 'alignments';

var reset = function reset() {
  (0, _reactDom.render)(_react.default.createElement("div", null), root);
  rerender();
};

var handleThemeChange = function handleThemeChange(_, _ref) {
  var theme = _ref.value;
  currentTheme = theme;
  reset();
};

var handlePickerChange = function handlePickerChange(_, _ref2) {
  var picker = _ref2.value;
  currentPicker = picker;
  reset();
};

var handleReadOnlyChange = function handleReadOnlyChange(_, _ref3) {
  var value = _ref3.value;
  readOnly = value;
  reset();
};

var showRollups = true;

function handleShowRollupsChange() {
  showRollups = !showRollups;
  rerender();
}

var handleTabChange = function handleTabChange(_, _ref4) {
  var id = _ref4.id;
  currentTab = id;
  rerender();
};

function rerender() {
  (0, _reactDom.render)(_react.default.createElement(_uiThemeable.ApplyTheme, {
    theme: _uiThemeable.ApplyTheme.generateTheme(currentTheme)
  }, _react.default.createElement(_uiTabs.Tabs, {
    onRequestTabChange: handleTabChange
  }, _react.default.createElement(_uiTabs.Tabs.Panel, {
    id: "alignments",
    renderTitle: "Alignments",
    selected: currentTab === 'alignments'
  }, _react.default.createElement(_uiSimpleSelect.SimpleSelect, {
    renderLabel: "Picker",
    onChange: handlePickerChange,
    value: currentPicker,
    "data-automation": "demoAlignment__pickerSelect"
  }, _react.default.createElement(_uiSimpleSelect.SimpleSelect.Option, {
    id: "dialog",
    value: "dialog"
  }, "Dialog Picker"), _react.default.createElement(_uiSimpleSelect.SimpleSelect.Option, {
    id: "tray",
    value: "tray"
  }, "Tray Picker")), _react.default.createElement(_uiSimpleSelect.SimpleSelect, {
    renderLabel: "Read only",
    onChange: handleReadOnlyChange,
    value: readOnly
  }, _react.default.createElement(_uiSimpleSelect.SimpleSelect.Option, {
    id: "true",
    key: "true",
    value: "true"
  }, "true"), _react.default.createElement(_uiSimpleSelect.SimpleSelect.Option, {
    id: "false",
    key: "false",
    value: "false"
  }, "false")), _react.default.createElement(DemoAlignment, {
    name: "Quiz #99",
    alignmentSetId: "d15f9530-81af-4ab5-9da7-7b49ee1aac0d",
    artifactType: artifactType,
    artifactId: artifactId,
    contextUuid: "dummy_uuid",
    emptySetHeading: "Align Institution outcomes to this quiz.",
    displayMasteryDescription: true,
    displayMasteryPercentText: true,
    artifactTypeName: "Quiz",
    jwt: createJwt
  }), _react.default.createElement(DemoAlignment, {
    alignmentSetId: "",
    name: "Question #100",
    contextUuid: "dummy_uuid",
    artifactType: "quizzes.item",
    artifactId: "100",
    emptySetHeading: "Align Institution outcomes to this question.",
    jwt: createJwt
  }), _react.default.createElement(DemoAlignment, {
    alignmentSetId: "",
    name: "Kindergarten Science Question #101",
    artifactType: "quizzes.item",
    artifactId: "101",
    contextUuid: "K-science",
    emptySetHeading: "Align Institution outcomes to this question.",
    jwt: createKindergartenJwt
  }), _react.default.createElement(DemoAlignment, {
    alignmentSetId: "",
    name: "First Grade Science Question #102",
    artifactType: "quizzes.item",
    artifactId: "102",
    contextUuid: "1-science",
    emptySetHeading: "Align Institution outcomes to this question.",
    jwt: createFirstGradeJwt
  }), _react.default.createElement(DemoAlignment, {
    alignmentSetId: "",
    useAlignmentButton: true,
    name: "Quiz #103",
    artifactType: "quizzes.quiz",
    artifactId: "103",
    contextUuid: "dummy_uuid",
    emptySetHeading: "Align Institution outcomes to this quiz.",
    jwt: createJwt,
    alignmentWidget: _index.AlignmentButton
  })), _react.default.createElement(_uiTabs.Tabs.Panel, {
    selected: currentTab === 'report',
    renderTitle: "Report",
    textAlign: "center",
    id: "report"
  }, _react.default.createElement("div", {
    style: {
      backgroundColor: 'lightgrey'
    }
  }, _react.default.createElement(_uiCheckbox.Checkbox, {
    label: "Show Rollups",
    checked: showRollups,
    onChange: handleShowRollupsChange
  }), _react.default.createElement("div", {
    className: styles.report
  }, _react.default.createElement(_index.OutcomesPerStudentReport, {
    artifactType: artifactType,
    artifactId: artifactId,
    host: outcomesHost,
    jwt: reportJwt,
    scope: "report",
    contextUuid: "dummy_uuid",
    showRollups: showRollups
  })))), _react.default.createElement(_uiTabs.Tabs.Panel, {
    title: "Theme",
    textAlign: "center",
    id: "theme",
    selected: currentTab === 'theme'
  }, _react.default.createElement(_uiSimpleSelect.SimpleSelect, {
    renderLabel: "Theme",
    onChange: handleThemeChange,
    value: currentTheme
  }, themes.map(function (themeKey) {
    return _react.default.createElement(_uiSimpleSelect.SimpleSelect.Option, {
      id: themeKey,
      key: themeKey,
      value: themeKey
    }, themeKey);
  }))))), root);
}

rerender();