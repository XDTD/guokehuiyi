"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _chai = require("chai");

var _immutable = require("immutable");

var _actions = require("../actions");

var _reducers = _interopRequireDefault(require("../reducers"));

describe('reports/reducers', function () {
  // eslint-disable-next-line camelcase
  var user_uuid = '560fddd9-9b16-4e3a-969c-2f095e7afc78';
  var state = (0, _immutable.fromJS)({
    rollups: {
      100: {
        id: 100,
        label: 'blue',
        title: 'green'
      }
    },
    results: {
      1955: (0, _defineProperty2.default)({}, user_uuid, {
        user_uuid: user_uuid,
        percent_score: 0.8,
        points: 80.0,
        points_possible: 100.0
      })
    },
    users: [{
      uuid: '100'
    }, {
      uuid: '200'
    }],
    openReportAlignmentId: 10
  });
  describe('page', function () {
    it('is updated by setPage', function () {
      var newPage = {
        number: 10,
        loading: true
      };
      var newState = (0, _reducers.default)(state, (0, _actions.setPage)(newPage));
      (0, _chai.expect)(newState.get('page').toJS()).to.deep.equal(newPage);
    });
  });
  describe('pageData', function () {
    it('is updated by setPageData', function () {
      var newPageData = {
        perPage: 50,
        total: 597
      };
      var newState = (0, _reducers.default)(state, (0, _actions.setPageData)(newPageData));
      (0, _chai.expect)(newState.get('pageData').toJS()).to.deep.equal(newPageData);
    });
  });
  describe('rollups', function () {
    it('is updated by setRollups', function () {
      var newRollup = {
        id: 200,
        label: 'yellow',
        title: 'red'
      };
      var newState = (0, _reducers.default)(state, (0, _actions.setRollups)([newRollup]));
      (0, _chai.expect)(newState.get('rollups').toJS()).to.deep.equal([newRollup]);
    });
  });
  describe('results', function () {
    it('is updated by setResults', function () {
      var result = {
        user_uuid: user_uuid,
        points: 95.0,
        points_possible: 100
      };
      var newResults = {
        outcomeId: '1955',
        results: [result]
      };
      var newState = (0, _reducers.default)(state, (0, _actions.setResults)(newResults));
      (0, _chai.expect)(newState.getIn(['results', '1955', user_uuid.toString()]).toJS()).to.deep.equal({
        userId: user_uuid,
        percentScore: result.percent_score,
        points: result.points,
        pointsPossible: result.points_possible
      });
    });
  });
  describe('openReportAlignmentId', function () {
    it('is set by VIEW_REPORT_ALIGNMENT', function () {
      var newState = (0, _reducers.default)(state, (0, _actions.viewReportAlignment)(99));
      (0, _chai.expect)(newState.get('openReportAlignmentId')).to.equal(99);
    });
    it('is cleared by CLOSE_REPORT_ALIGNMENT', function () {
      var newState = (0, _reducers.default)(state, (0, _actions.closeReportAlignment)(null));
      (0, _chai.expect)(newState.get('openReportAlignmentId')).to.equal(null);
    });
  });
  describe('users', function () {
    it('is updated by setUsers', function () {
      var newUsers = [{
        uuid: '200'
      }, {
        uuid: '300'
      }];
      var newState = (0, _reducers.default)(state, (0, _actions.setUsers)(newUsers));
      (0, _chai.expect)(newState.get('users').toJS()).to.deep.equal(newUsers);
    });
  });
});